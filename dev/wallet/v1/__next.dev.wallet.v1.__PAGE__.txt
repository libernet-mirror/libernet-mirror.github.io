1:"$Sreact.fragment"
33:I[97367,["/_next/static/chunks/ff1a16fafef87110.js","/_next/static/chunks/247eb132b7f7b574.js"],"OutletBoundary"]
34:"$Sreact.suspense"
0:{"buildId":"NORcPBXanOqsrijs2w26D","rsc":["$","$1","c",{"children":[[["$","h2",null,{"id":"overview","children":[["$","a",null,{"aria-hidden":"true","tabIndex":"-1","href":"#overview","children":["$","span",null,{"className":"icon icon-link"}]}],"Overview"]}],"\n",["$","p",null,{"children":"This page specifies the file format used to store Libernet wallets and the process to derive the\nactual accounts of a wallet."}],"\n",["$","h2",null,{"id":"anatomy-of-an-account","children":[["$","a",null,{"aria-hidden":"true","tabIndex":"-1","href":"#anatomy-of-an-account","children":["$","span",null,{"className":"icon icon-link"}]}],"Anatomy of an Account"]}],"\n",["$","p",null,{"children":["An account is a ",["$","a",null,{"href":"https://hackmd.io/@benjaminion/bls12-381","children":"BLS12-381"}]," key pair that can be used to sign Libernet transactions. On\nthe public ledger, accounts are known by their ",["$","em",null,{"children":"address"}],", which is computed using the SHA3 hash of\nthe public BLS key (see the following sections for the exact procedure)."]}],"\n",["$","p",null,{"children":"Example account:"}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":["private BLS key scalar (32 bytes): ",["$","code",null,{"children":"0x2dde5ffbbc881910a9b1cc9567eae3c1e3f8563f4e2771eb9957ead7b7d6a3c5"}]]}],"\n",["$","li",null,{"children":["public BLS key point in compressed form (48 bytes): ",["$","code",null,{"children":"0xaa4130eebea382e2c4312186290585d620b858c41a4316d8b62beacb0a443690d7d751ddd7b12eaa58470d29a0bf468b"}]]}],"\n",["$","li",null,{"children":["account address (a BLS scalar computed from the SHA3 hash of the public key): ",["$","code",null,{"children":"0x210b0a3a23416f66a210531ec98db0fc39162b288f48de9289a6186af4f3eba1"}]]}],"\n"]}],"\n",["$","div",null,{"className":"my-8 flex rounded-3xl p-6 bg-amber-50 dark:bg-slate-800/60 dark:ring-1 dark:ring-slate-300/10","children":[["$","svg",null,{"viewBox":"0 0 32 32","fill":"none","className":"h-8 w-8 flex-none [--icon-foreground:var(--color-amber-900)] [--icon-background:var(--color-amber-100)]","children":[["$","defs",null,{"children":[["$","radialGradient",null,{"cx":0,"cy":0,"r":1,"gradientUnits":"userSpaceOnUse","id":"_S_1_-gradient","gradientTransform":"rotate(65.924 1.519 20.92) scale(25.7391)","children":[["$","stop","0",{"stopColor":"#FDE68A","offset":".08"}],["$","stop","1",{"stopColor":"#F59E0B","offset":".837"}]]}],["$","radialGradient",null,{"cx":0,"cy":0,"r":1,"gradientUnits":"userSpaceOnUse","id":"_S_1_-gradient-dark","gradientTransform":"matrix(0 24.5 -24.5 0 16 5.5)","children":[["$","stop","0",{"stopColor":"#FDE68A","offset":".08"}],["$","stop","1",{"stopColor":"#F59E0B","offset":".837"}]]}]]}],["$","g",null,{"className":"dark:hidden","children":[["$","circle",null,{"cx":20,"cy":20,"r":12,"fill":"url(#_S_1_-gradient)"}],["$","path",null,{"d":"M3 16c0 7.18 5.82 13 13 13s13-5.82 13-13S23.18 3 16 3 3 8.82 3 16Z","fillOpacity":0.5,"className":"fill-(--icon-background) stroke-(--icon-foreground)","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round"}],["$","path",null,{"d":"m15.408 16.509-1.04-5.543a1.66 1.66 0 1 1 3.263 0l-1.039 5.543a.602.602 0 0 1-1.184 0Z","className":"fill-(--icon-foreground) stroke-(--icon-foreground)","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round"}],["$","path",null,{"d":"M16 23a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z","fillOpacity":0.5,"stroke":"currentColor","className":"fill-(--icon-background) stroke-(--icon-foreground)","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round"}]]}],["$","g",null,{"className":"hidden dark:inline","children":["$","path",null,{"fillRule":"evenodd","clipRule":"evenodd","d":"M2 16C2 8.268 8.268 2 16 2s14 6.268 14 14-6.268 14-14 14S2 23.732 2 16Zm11.386-4.85a2.66 2.66 0 1 1 5.228 0l-1.039 5.543a1.602 1.602 0 0 1-3.15 0l-1.04-5.543ZM16 20a2 2 0 1 0 0 4 2 2 0 0 0 0-4Z","fill":"url(#_S_1_-gradient-dark)"}]}]]}],["$","div",null,{"className":"ml-4 flex-auto","children":[["$","p",null,{"className":"not-prose font-display text-xl text-amber-900 dark:text-amber-500","children":"Warning"}],["$","div",null,{"className":"prose mt-2.5 text-amber-800 [--tw-prose-underline:var(--color-amber-400)] [--tw-prose-background:var(--color-amber-50)] prose-a:text-amber-900 prose-code:text-amber-900 dark:text-slate-300 dark:[--tw-prose-underline:var(--color-sky-700)] dark:prose-code:text-slate-300","children":["\n","$L2","\n","$L3","\n"]}]]}]]}],"\n","$L4","\n","$L5","\n","$L6","\n","$L7","\n","$L8","\n","$L9","\n","$La","\n","$Lb","\n","$Lc","\n","$Ld","\n","$Le","\n","$Lf","\n","$L10","\n","$L11","\n","$L12","\n","$L13","\n","$L14","\n","$L15","\n","$L16","\n","$L17","\n","$L18","\n","$L19","\n","$L1a","\n","$L1b","\n","$L1c","\n","$L1d","\n","$L1e","\n","$L1f","\n","$L20","\n","$L21","\n","$L22","\n","$L23","\n","$L24","\n","$L25"],null,"$L26"]}],"loading":null,"isPartial":false}
2:null
3:["\n",["$","p",null,{"children":["Do not use the account above, it's leaked. Any assets transferred to this account will be\n",["$","strong",null,{"children":"permanently lost"}],"."]}],"\n"]
4:["$","p",null,{"children":"The public ledger associates LIB balances and other assets to account addresses, and the protocol\ngrants ownership of such assets to the key pair whose public key hashes to the corresponding\naddress."}]
5:["$","h2",null,{"id":"wallet-features","children":[["$","a",null,{"aria-hidden":"true","tabIndex":"-1","href":"#wallet-features","children":["$","span",null,{"className":"icon icon-link"}]}],"Wallet Features"]}]
6:["$","p",null,{"children":"A single wallet file can derive an unlimited number of accounts. These accounts are completely\nindependent of each other, meaning it's infeasible for any external actors to determine whether any\ntwo given accounts were generated from the same wallet."}]
7:["$","p",null,{"children":"Wallets have a seed and one or more associated passwords (up to 10). The algorithm to derive an\nactual account key pair uses the seed and one of the passwords. As a result, different passwords\nwill generate completely different accounts, and this is the basis for Libernet's plausible\ndeniability scheme."}]
8:["$","p",null,{"children":["The seed of a wallet is stored in cleartext in the wallet file, while the passwords are never stored\ndirectly. Instead, we use the ",["$","a",null,{"href":"https://dankradfeist.de/ethereum/2020/06/16/kate-polynomial-commitments.html","children":"KZG polynomial commitment scheme"}]," to commit to them and check\npassword correctness when a user wants to unlock a wallet."]}]
9:["$","h2",null,{"id":"wallet-format","children":[["$","a",null,{"aria-hidden":"true","tabIndex":"-1","href":"#wallet-format","children":["$","span",null,{"className":"icon icon-link"}]}],"Wallet Format"]}]
a:["$","p",null,{"children":["A version 1 Libernet wallet file is a ",["$","a",null,{"href":"https://www.json.org/","children":"JSON"}]," file with the following fields:"]}]
b:["$","ul",null,{"children":["\n",["$","li",null,{"children":[["$","code",null,{"children":"version"}]," must be the string ",["$","code",null,{"children":"1.0"}],"."]}],"\n",["$","li",null,{"children":[["$","code",null,{"children":"seed"}]," is a 64-byte random number stored as a string in lower-case hex format prefixed with ",["$","code",null,{"children":"0x"}],",\ne.g. ",["$","code",null,{"children":"0x4bbda518f23220af8eb7e8324cf132c0733b9c876c8e3112c69a27b779d22bf8bb7d089e1ef1706772abd511fc5b45f654e9fcb31fe30875bd6ff0648585cf92"}],"."]}],"\n",["$","li",null,{"children":[["$","code",null,{"children":"c"}]," is a BLS point over G1 in compressed format (48 bytes), stored as a string in lower-case hex\nformat prefixed with ",["$","code",null,{"children":"0x"}],"."]}],"\n",["$","li",null,{"children":[["$","code",null,{"children":"y"}]," is an array containing exactly 10 BLS points over G1, each having the same format as ",["$","code",null,{"children":"c"}],"."]}],"\n"]}]
c:["$","p",null,{"children":"Example wallet:"}]
d:["$","div",null,{"className":"my-8 flex rounded-3xl p-6 bg-amber-50 dark:bg-slate-800/60 dark:ring-1 dark:ring-slate-300/10","children":[["$","svg",null,{"viewBox":"0 0 32 32","fill":"none","className":"h-8 w-8 flex-none [--icon-foreground:var(--color-amber-900)] [--icon-background:var(--color-amber-100)]","children":[["$","defs",null,{"children":[["$","radialGradient",null,{"cx":0,"cy":0,"r":1,"gradientUnits":"userSpaceOnUse","id":"_S_2_-gradient","gradientTransform":"rotate(65.924 1.519 20.92) scale(25.7391)","children":[["$","stop","0",{"stopColor":"#FDE68A","offset":".08"}],["$","stop","1",{"stopColor":"#F59E0B","offset":".837"}]]}],["$","radialGradient",null,{"cx":0,"cy":0,"r":1,"gradientUnits":"userSpaceOnUse","id":"_S_2_-gradient-dark","gradientTransform":"matrix(0 24.5 -24.5 0 16 5.5)","children":[["$","stop","0",{"stopColor":"#FDE68A","offset":".08"}],["$","stop","1",{"stopColor":"#F59E0B","offset":".837"}]]}]]}],["$","g",null,{"className":"dark:hidden","children":[["$","circle",null,{"cx":20,"cy":20,"r":12,"fill":"url(#_S_2_-gradient)"}],["$","path",null,{"d":"M3 16c0 7.18 5.82 13 13 13s13-5.82 13-13S23.18 3 16 3 3 8.82 3 16Z","fillOpacity":0.5,"className":"fill-(--icon-background) stroke-(--icon-foreground)","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round"}],["$","path",null,{"d":"m15.408 16.509-1.04-5.543a1.66 1.66 0 1 1 3.263 0l-1.039 5.543a.602.602 0 0 1-1.184 0Z","className":"fill-(--icon-foreground) stroke-(--icon-foreground)","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round"}],["$","path",null,{"d":"M16 23a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z","fillOpacity":0.5,"stroke":"currentColor","className":"fill-(--icon-background) stroke-(--icon-foreground)","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round"}]]}],["$","g",null,{"className":"hidden dark:inline","children":["$","path",null,{"fillRule":"evenodd","clipRule":"evenodd","d":"M2 16C2 8.268 8.268 2 16 2s14 6.268 14 14-6.268 14-14 14S2 23.732 2 16Zm11.386-4.85a2.66 2.66 0 1 1 5.228 0l-1.039 5.543a1.602 1.602 0 0 1-3.15 0l-1.04-5.543ZM16 20a2 2 0 1 0 0 4 2 2 0 0 0 0-4Z","fill":"url(#_S_2_-gradient-dark)"}]}]]}],["$","div",null,{"className":"ml-4 flex-auto","children":[["$","p",null,{"className":"not-prose font-display text-xl text-amber-900 dark:text-amber-500","children":"Warning"}],["$","div",null,{"className":"prose mt-2.5 text-amber-800 [--tw-prose-underline:var(--color-amber-400)] [--tw-prose-background:var(--color-amber-50)] prose-a:text-amber-900 prose-code:text-amber-900 dark:text-slate-300 dark:[--tw-prose-underline:var(--color-sky-700)] dark:prose-code:text-slate-300","children":["\n",null,"\n",["\n",["$","p",null,{"children":"Do not use the following wallet, it's leaked."}],"\n"],"\n"]}]]}]]}]
e:["$","div",null,{"className":"remark-highlight","children":["$","pre",null,{"className":"language-json","children":["$","code",null,{"className":"language-json","children":[["$","span",null,{"className":"token punctuation","children":"{"}],"\n  ",["$","span",null,{"className":"token property","children":"\"version\""}],["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token string","children":"\"1.0\""}],["$","span",null,{"className":"token punctuation","children":","}],"\n  ",["$","span",null,{"className":"token property","children":"\"seed\""}],["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token string","children":"\"0x4bbda518f23220af8eb7e8324cf132c0733b9c876c8e3112c69a27b779d22bf8bb7d089e1ef1706772abd511fc5b45f654e9fcb31fe30875bd6ff0648585cf92\""}],["$","span",null,{"className":"token punctuation","children":","}],"\n  ",["$","span",null,{"className":"token property","children":"\"c\""}],["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token string","children":"\"0x801779b8613e11f65317ccdb11c950461b9c305276e06d65316d66322b23d85088a0e9b68381a4531d970062345825e7\""}],["$","span",null,{"className":"token punctuation","children":","}],"\n  ",["$","span",null,{"className":"token property","children":"\"y\""}],["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token punctuation","children":"["}],"\n    ",["$","span",null,{"className":"token string","children":"\"0xb466b114add86cef49255e1479436eb4fe49798dbb7573bbf073cb8b9ceee5bf09d3e2465fec4fb9d7819bff62288373\""}],["$","span",null,{"className":"token punctuation","children":","}],"\n    ",["$","span",null,{"className":"token string","children":"\"0x8de02594854b5ce06126cdfb0984be3d0b9bc162236c1221f951c358f160d1063397a2e9496366eb4d5c876946234a40\""}],["$","span",null,{"className":"token punctuation","children":","}],"\n    ",["$","span",null,{"className":"token string","children":"\"0x900b96dbccd6309840fa075ce54d61a25c212076c329cbdc425e3dbe74380ced054960d144560903112b3ed53ff96d03\""}],["$","span",null,{"className":"token punctuation","children":","}],"\n    ",["$","span",null,{"className":"token string","children":"\"0xa4fbeb582ce042e4e9f37db0eca05a1b47293873dc12fd2901dd4822f9017ecf57bf6169af8121daf67755661c18393e\""}],["$","span",null,{"className":"token punctuation","children":","}],"\n    ",["$","span",null,{"className":"token string","children":"\"0x83332293c2508f407a4c56792e4e6f06f209bb7751ce0f738c379548fbf9e1f76adfd6f11fc40885a0538f6893683a36\""}],["$","span",null,{"className":"token punctuation","children":","}],"\n    ",["$","span",null,{"className":"token string","children":"\"0x881cded5f5efcf4c1618b727bdcc6ecf509a658b7e422b556feab0df4948012a7e65cd89f25bf62f81529136baee0630\""}],["$","span",null,{"className":"token punctuation","children":","}],"\n    ",["$","span",null,{"className":"token string","children":"\"0x858c616dad16af911b8afad048de067c5f8e092f82d895f2b0a0f8f0a211a84ff39ce5545d2b7e01becea48fc96b425e\""}],["$","span",null,{"className":"token punctuation","children":","}],"\n    ",["$","span",null,{"className":"token string","children":"\"0xb30942bb2f1a7bfc90bbbd9a0b23fe1b08478ad38fab2ed7bcd75c6785f3d2f6d6e6e5e59cececacece4376922ad30a8\""}],["$","span",null,{"className":"token punctuation","children":","}],"\n    ",["$","span",null,{"className":"token string","children":"\"0x87abdc824b25ec12162b3062217e5216c624d15a050ccd4d6cc2ad3f9b13f7c9dbda05f9114e49b922bad788e2e5c825\""}],["$","span",null,{"className":"token punctuation","children":","}],"\n    ",["$","span",null,{"className":"token string","children":"\"0x85d650e5a5c1ea3ebf4d575f143251158600c4c3bfd2e0fbbc883dd7d1d40f5ca9ddbb91efc3eed5825e62814150a1a8\""}],"\n  ",["$","span",null,{"className":"token punctuation","children":"]"}],"\n",["$","span",null,{"className":"token punctuation","children":"}"}],"\n"]}]}]}]
f:["$","h2",null,{"id":"derivation-algorithm","children":[["$","a",null,{"aria-hidden":"true","tabIndex":"-1","href":"#derivation-algorithm","children":["$","span",null,{"className":"icon icon-link"}]}],"Derivation Algorithm"]}]
10:["$","h3",null,{"id":"general-notes","children":[["$","a",null,{"aria-hidden":"true","tabIndex":"-1","href":"#general-notes","children":["$","span",null,{"className":"icon icon-link"}]}],"General Notes"]}]
11:["$","p",null,{"children":"In the following algorithm we perform modular reduction from 512-bit integers to BLS scalars every\ntime we need to switch to algebraic cryptography, e.g. when converting a SHA3 hash to a scalar. The\nreason why we use 512-bit cryptography despite 256 bits being generally considered safe is to\nwarrant a uniform distribution of the resulting scalar."}]
12:["$","p",null,{"children":"The order of the BLS12-381 scalar field is the following ~255-bit prime number:"}]
13:["$","div",null,{"className":"remark-highlight","children":["$","pre",null,{"className":"language-unknown","children":["$","code",null,{"className":"language-unknown","children":"r = 0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001"}]}]}]
14:["$","p",null,{"children":["Note that the first few nibbles are ",["$","code",null,{"children":"73ed..."}],", so this value is roughly 0.45 times the full 256-bit\nrange. Performing modular reduction from the 256-bit range to the ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"r"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"r"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.4306em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.02778em"},"children":"r"}]]}]}]]}]," range would result in a\nvisible skew of the distribution, as ~10% of the values would become 50% more frequent."]}]
15:["$","p",null,{"children":["On the other hand, the 512-bit range is astronomically larger than ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"r"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"r"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.4306em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.02778em"},"children":"r"}]]}]}]]}]," (more than ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","msup",null,{"children":[["$","mn",null,{"children":"2"}],["$","mn",null,{"children":"256"}]]}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"2^{256}"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.8141em"}}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord","children":"2"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t","children":["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.8141em"},"children":["$","span",null,{"style":{"top":"-3.063em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mtight","children":["$","span",null,{"className":"mord mtight","children":"256"}]}]}]]}]}]}]}]}]]}]]}]}]]}]," times\nlarger), so in this case the distribution bias resulting from modular reduction is virtually\nnon-existent."]}]
16:["$","p",null,{"children":["None of the 512-bit values we use in this type of conversion have endianness, so we always assume\n",["$","strong",null,{"children":"little endian order"}],"."]}]
17:["$","h3",null,{"id":"setup-phase","children":[["$","a",null,{"aria-hidden":"true","tabIndex":"-1","href":"#setup-phase","children":["$","span",null,{"className":"icon icon-link"}]}],"Setup Phase"]}]
18:["$","ol",null,{"children":["\n",["$","li",null,{"children":["\n",["$","p",null,{"children":["Generate the 64-byte seed using a CSPRNG. Let ",["$","code",null,{"children":"s"}]," be this seed."]}],"\n"]}],"\n",["$","li",null,{"children":["\n",["$","p",null,{"children":"Let the user enter at least one and at most 10 different passwords. Error out if two or more\npasswords are identical."}],"\n"]}],"\n",["$","li",null,{"children":["\n",["$","p",null,{"children":["Derive a 64-byte key for each password using the ",["$","a",null,{"href":"https://en.wikipedia.org/wiki/Argon2","children":"Argon2id"}]," key derivation function with\nthe following parameters:"]}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"algorithm version: 19 (0x13)"}],"\n",["$","li",null,{"children":"M cost: 256 * 1024 (= 256 MiB)"}],"\n",["$","li",null,{"children":"T cost: 2"}],"\n",["$","li",null,{"children":"P cost: 1"}],"\n",["$","li",null,{"children":["salt: the seed ",["$","code",null,{"children":"s"}]]}],"\n",["$","li",null,{"children":"output length: 64 bytes"}],"\n"]}],"\n",["$","p",null,{"children":"The passwords must be encoded in UTF-8."}],"\n"]}],"\n",["$","li",null,{"children":["\n",["$","p",null,{"children":"If the user provided less than 10 passwords, add more randomly generated 64-byte keys until there\nare 10 keys in total. All random keys must be generated by a CSPRNG."}],"\n"]}],"\n",["$","li",null,{"children":["\n",["$","p",null,{"children":["Convert the 10 keys to corresponding BLS scalars via modular reduction. Let ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","msub",null,{"children":[["$","mi",null,{"children":"z"}],["$","mi",null,{"children":"i"}]]}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"z_i"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.5806em","verticalAlign":"-0.15em"}}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.04398em"},"children":"z"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.3117em"},"children":["$","span",null,{"style":{"top":"-2.55em","marginLeft":"-0.044em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mathnormal mtight","children":"i"}]}]]}]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.15em"},"children":["$","span",null,{}]}]}]]}]}]]}]]}]}]]}]," be the ",["$","em",null,{"children":"i"}],"-th\nscalar."]}],"\n"]}],"\n",["$","li",null,{"children":["\n",["$","p",null,{"children":["Compute a polynomial whose roots are the 10 scalars ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","msub",null,{"children":[["$","mi",null,{"children":"z"}],["$","mn",null,{"children":"0"}]]}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"z_0"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.5806em","verticalAlign":"-0.15em"}}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.04398em"},"children":"z"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.3011em"},"children":["$","span",null,{"style":{"top":"-2.55em","marginLeft":"-0.044em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mtight","children":"0"}]}]]}]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.15em"},"children":["$","span",null,{}]}]}]]}]}]]}]]}]}]]}],", ","$L27",", etc. Let ","$L28"," be this\npolynomial. ","$L29"," can be computed as:"]}],"\n","$L2a","\n","$L2b","\n"]}],"\n","$L2c","\n","$L2d","\n","$L2e","\n"]}]
19:["$","div",null,{"className":"my-8 flex rounded-3xl p-6 bg-sky-50 dark:bg-slate-800/60 dark:ring-1 dark:ring-slate-300/10","children":[["$","svg",null,{"viewBox":"0 0 32 32","fill":"none","className":"h-8 w-8 flex-none [--icon-foreground:var(--color-slate-900)] [--icon-background:var(--color-white)]","children":[["$","defs",null,{"children":[["$","radialGradient",null,{"cx":0,"cy":0,"r":1,"gradientUnits":"userSpaceOnUse","id":"_S_3_-gradient","gradientTransform":"matrix(0 21 -21 0 20 11)","children":[["$","stop","0",{"stopColor":"#0EA5E9"}],["$","stop","1",{"stopColor":"#22D3EE","offset":".527"}],["$","stop","2",{"stopColor":"#818CF8","offset":1}]]}],["$","radialGradient",null,{"cx":0,"cy":0,"r":1,"gradientUnits":"userSpaceOnUse","id":"_S_3_-gradient-dark","gradientTransform":"matrix(0 24.5001 -19.2498 0 16 5.5)","children":[["$","stop","0",{"stopColor":"#0EA5E9"}],["$","stop","1",{"stopColor":"#22D3EE","offset":".527"}],["$","stop","2",{"stopColor":"#818CF8","offset":1}]]}]]}],["$","g",null,{"className":"dark:hidden","children":[["$","circle",null,{"cx":20,"cy":20,"r":12,"fill":"url(#_S_3_-gradient)"}],["$","path",null,{"fillRule":"evenodd","clipRule":"evenodd","d":"M20 24.995c0-1.855 1.094-3.501 2.427-4.792C24.61 18.087 26 15.07 26 12.231 26 7.133 21.523 3 16 3S6 7.133 6 12.23c0 2.84 1.389 5.857 3.573 7.973C10.906 21.494 12 23.14 12 24.995V27a2 2 0 0 0 2 2h4a2 2 0 0 0 2-2v-2.005Z","className":"fill-(--icon-background)","fillOpacity":0.5}],["$","path",null,{"d":"M25 12.23c0 2.536-1.254 5.303-3.269 7.255l1.391 1.436c2.354-2.28 3.878-5.547 3.878-8.69h-2ZM16 4c5.047 0 9 3.759 9 8.23h2C27 6.508 21.998 2 16 2v2Zm-9 8.23C7 7.76 10.953 4 16 4V2C10.002 2 5 6.507 5 12.23h2Zm3.269 7.255C8.254 17.533 7 14.766 7 12.23H5c0 3.143 1.523 6.41 3.877 8.69l1.392-1.436ZM13 27v-2.005h-2V27h2Zm1 1a1 1 0 0 1-1-1h-2a3 3 0 0 0 3 3v-2Zm4 0h-4v2h4v-2Zm1-1a1 1 0 0 1-1 1v2a3 3 0 0 0 3-3h-2Zm0-2.005V27h2v-2.005h-2ZM8.877 20.921C10.132 22.136 11 23.538 11 24.995h2c0-2.253-1.32-4.143-2.731-5.51L8.877 20.92Zm12.854-1.436C20.32 20.852 19 22.742 19 24.995h2c0-1.457.869-2.859 2.122-4.074l-1.391-1.436Z","className":"fill-(--icon-foreground)"}],["$","path",null,{"d":"M20 26a1 1 0 1 0 0-2v2Zm-8-2a1 1 0 1 0 0 2v-2Zm2 0h-2v2h2v-2Zm1 1V13.5h-2V25h2Zm-5-11.5v1h2v-1h-2Zm3.5 4.5h5v-2h-5v2Zm8.5-3.5v-1h-2v1h2ZM20 24h-2v2h2v-2Zm-2 0h-4v2h4v-2Zm-1-10.5V25h2V13.5h-2Zm2.5-2.5a2.5 2.5 0 0 0-2.5 2.5h2a.5.5 0 0 1 .5-.5v-2Zm2.5 2.5a2.5 2.5 0 0 0-2.5-2.5v2a.5.5 0 0 1 .5.5h2ZM18.5 18a3.5 3.5 0 0 0 3.5-3.5h-2a1.5 1.5 0 0 1-1.5 1.5v2ZM10 14.5a3.5 3.5 0 0 0 3.5 3.5v-2a1.5 1.5 0 0 1-1.5-1.5h-2Zm2.5-3.5a2.5 2.5 0 0 0-2.5 2.5h2a.5.5 0 0 1 .5-.5v-2Zm2.5 2.5a2.5 2.5 0 0 0-2.5-2.5v2a.5.5 0 0 1 .5.5h2Z","className":"fill-(--icon-foreground)"}]]}],["$","g",null,{"className":"hidden dark:inline","children":["$","path",null,{"fillRule":"evenodd","clipRule":"evenodd","d":"M16 2C10.002 2 5 6.507 5 12.23c0 3.144 1.523 6.411 3.877 8.691.75.727 1.363 1.52 1.734 2.353.185.415.574.726 1.028.726H12a1 1 0 0 0 1-1v-4.5a.5.5 0 0 0-.5-.5A3.5 3.5 0 0 1 9 14.5V14a3 3 0 1 1 6 0v9a1 1 0 1 0 2 0v-9a3 3 0 1 1 6 0v.5a3.5 3.5 0 0 1-3.5 3.5.5.5 0 0 0-.5.5V23a1 1 0 0 0 1 1h.36c.455 0 .844-.311 1.03-.726.37-.833.982-1.626 1.732-2.353 2.354-2.28 3.878-5.547 3.878-8.69C27 6.507 21.998 2 16 2Zm5 25a1 1 0 0 0-1-1h-8a1 1 0 0 0-1 1 3 3 0 0 0 3 3h4a3 3 0 0 0 3-3Zm-8-13v1.5a.5.5 0 0 1-.5.5 1.5 1.5 0 0 1-1.5-1.5V14a1 1 0 1 1 2 0Zm6.5 2a.5.5 0 0 1-.5-.5V14a1 1 0 1 1 2 0v.5a1.5 1.5 0 0 1-1.5 1.5Z","fill":"url(#_S_3_-gradient-dark)"}]}]]}],["$","div",null,{"className":"ml-4 flex-auto","children":[["$","p",null,{"className":"not-prose font-display text-xl text-sky-900 dark:text-sky-400","children":"Note"}],["$","div",null,{"className":"prose mt-2.5 text-sky-800 [--tw-prose-background:var(--color-sky-50)] prose-a:text-sky-900 prose-code:text-sky-900 dark:text-slate-300 dark:prose-code:text-slate-300","children":["\n","$L2f","\n","$L30","\n"]}]]}]]}]
1a:["$","h3",null,{"id":"unlock-phase","children":[["$","a",null,{"aria-hidden":"true","tabIndex":"-1","href":"#unlock-phase","children":["$","span",null,{"className":"icon icon-link"}]}],"Unlock Phase"]}]
1b:["$","ol",null,{"children":["\n",["$","li",null,{"children":["\n",["$","p",null,{"children":"Let the user enter a password, encode it in UTF-8, and derive the corresponding Argon2id key\nusing the parameters above."}],"\n"]}],"\n",["$","li",null,{"children":["\n",["$","p",null,{"children":["Convert the 64-byte Argon2id key to a BLS scalar via modular reduction. Let ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"z"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"z"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.4306em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.04398em"},"children":"z"}]]}]}]]}]," be this scalar."]}],"\n"]}],"\n",["$","li",null,{"children":["\n",["$","p",null,{"children":["For each KZG proof in the ",["$","code",null,{"children":"y"}]," array:"]}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":["if the proof successfully verifies that ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"z"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"z"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.4306em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.04398em"},"children":"z"}]]}]}]]}]," is a root of the polynomial commited to by ",["$","code",null,{"children":"c"}],",\nthen the password is correct;"]}],"\n",["$","li",null,{"children":"if none of the proofs work, show an invalid password error message and exit."}],"\n"]}],"\n"]}],"\n",["$","li",null,{"children":["\n",["$","p",null,{"children":["To compute the private BLS key of the ",["$","em",null,{"children":"i"}],"-th account:"]}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":["Let ",["$","code",null,{"children":"H"}]," be the SHA3-512 hash of a 104-byte message built as follows:","\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":["the first 64 bytes are the seed ",["$","code",null,{"children":"s"}],","]}],"\n",["$","li",null,{"children":["the next 32 bytes are the key scalar ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"z"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"z"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.4306em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.04398em"},"children":"z"}]]}]}]]}]," in little endian order,"]}],"\n",["$","li",null,{"children":["the final 8 bytes are the index ",["$","code",null,{"children":"i"}]," in little endian order."]}],"\n"]}],"\n"]}],"\n",["$","li",null,{"children":["Convert ",["$","code",null,{"children":"H"}]," to a BLS scalar via modular reduction. The scalar is the private key."]}],"\n"]}],"\n"]}],"\n",["$","li",null,{"children":["\n",["$","p",null,{"children":"The public BLS key is computed over G1 as usual (ECC multiplication by the G1 generator point)."}],"\n"]}],"\n",["$","li",null,{"children":["\n",["$","p",null,{"children":"The account address is obtained by computing the SHA3-512 hash of the public key point in\ncompressed form (48 bytes) and converting the hash to a BLS scalar via modular reduction."}],"\n"]}],"\n"]}]
1c:["$","div",null,{"className":"my-8 flex rounded-3xl p-6 bg-sky-50 dark:bg-slate-800/60 dark:ring-1 dark:ring-slate-300/10","children":[["$","svg",null,{"viewBox":"0 0 32 32","fill":"none","className":"h-8 w-8 flex-none [--icon-foreground:var(--color-slate-900)] [--icon-background:var(--color-white)]","children":[["$","defs",null,{"children":[["$","radialGradient",null,{"cx":0,"cy":0,"r":1,"gradientUnits":"userSpaceOnUse","id":"_S_4_-gradient","gradientTransform":"matrix(0 21 -21 0 20 11)","children":[["$","stop","0",{"stopColor":"#0EA5E9"}],["$","stop","1",{"stopColor":"#22D3EE","offset":".527"}],["$","stop","2",{"stopColor":"#818CF8","offset":1}]]}],["$","radialGradient",null,{"cx":0,"cy":0,"r":1,"gradientUnits":"userSpaceOnUse","id":"_S_4_-gradient-dark","gradientTransform":"matrix(0 24.5001 -19.2498 0 16 5.5)","children":[["$","stop","0",{"stopColor":"#0EA5E9"}],["$","stop","1",{"stopColor":"#22D3EE","offset":".527"}],["$","stop","2",{"stopColor":"#818CF8","offset":1}]]}]]}],["$","g",null,{"className":"dark:hidden","children":[["$","circle",null,{"cx":20,"cy":20,"r":12,"fill":"url(#_S_4_-gradient)"}],["$","path",null,{"fillRule":"evenodd","clipRule":"evenodd","d":"M20 24.995c0-1.855 1.094-3.501 2.427-4.792C24.61 18.087 26 15.07 26 12.231 26 7.133 21.523 3 16 3S6 7.133 6 12.23c0 2.84 1.389 5.857 3.573 7.973C10.906 21.494 12 23.14 12 24.995V27a2 2 0 0 0 2 2h4a2 2 0 0 0 2-2v-2.005Z","className":"fill-(--icon-background)","fillOpacity":0.5}],["$","path",null,{"d":"M25 12.23c0 2.536-1.254 5.303-3.269 7.255l1.391 1.436c2.354-2.28 3.878-5.547 3.878-8.69h-2ZM16 4c5.047 0 9 3.759 9 8.23h2C27 6.508 21.998 2 16 2v2Zm-9 8.23C7 7.76 10.953 4 16 4V2C10.002 2 5 6.507 5 12.23h2Zm3.269 7.255C8.254 17.533 7 14.766 7 12.23H5c0 3.143 1.523 6.41 3.877 8.69l1.392-1.436ZM13 27v-2.005h-2V27h2Zm1 1a1 1 0 0 1-1-1h-2a3 3 0 0 0 3 3v-2Zm4 0h-4v2h4v-2Zm1-1a1 1 0 0 1-1 1v2a3 3 0 0 0 3-3h-2Zm0-2.005V27h2v-2.005h-2ZM8.877 20.921C10.132 22.136 11 23.538 11 24.995h2c0-2.253-1.32-4.143-2.731-5.51L8.877 20.92Zm12.854-1.436C20.32 20.852 19 22.742 19 24.995h2c0-1.457.869-2.859 2.122-4.074l-1.391-1.436Z","className":"fill-(--icon-foreground)"}],["$","path",null,{"d":"M20 26a1 1 0 1 0 0-2v2Zm-8-2a1 1 0 1 0 0 2v-2Zm2 0h-2v2h2v-2Zm1 1V13.5h-2V25h2Zm-5-11.5v1h2v-1h-2Zm3.5 4.5h5v-2h-5v2Zm8.5-3.5v-1h-2v1h2ZM20 24h-2v2h2v-2Zm-2 0h-4v2h4v-2Zm-1-10.5V25h2V13.5h-2Zm2.5-2.5a2.5 2.5 0 0 0-2.5 2.5h2a.5.5 0 0 1 .5-.5v-2Zm2.5 2.5a2.5 2.5 0 0 0-2.5-2.5v2a.5.5 0 0 1 .5.5h2ZM18.5 18a3.5 3.5 0 0 0 3.5-3.5h-2a1.5 1.5 0 0 1-1.5 1.5v2ZM10 14.5a3.5 3.5 0 0 0 3.5 3.5v-2a1.5 1.5 0 0 1-1.5-1.5h-2Zm2.5-3.5a2.5 2.5 0 0 0-2.5 2.5h2a.5.5 0 0 1 .5-.5v-2Zm2.5 2.5a2.5 2.5 0 0 0-2.5-2.5v2a.5.5 0 0 1 .5.5h2Z","className":"fill-(--icon-foreground)"}]]}],["$","g",null,{"className":"hidden dark:inline","children":["$","path",null,{"fillRule":"evenodd","clipRule":"evenodd","d":"M16 2C10.002 2 5 6.507 5 12.23c0 3.144 1.523 6.411 3.877 8.691.75.727 1.363 1.52 1.734 2.353.185.415.574.726 1.028.726H12a1 1 0 0 0 1-1v-4.5a.5.5 0 0 0-.5-.5A3.5 3.5 0 0 1 9 14.5V14a3 3 0 1 1 6 0v9a1 1 0 1 0 2 0v-9a3 3 0 1 1 6 0v.5a3.5 3.5 0 0 1-3.5 3.5.5.5 0 0 0-.5.5V23a1 1 0 0 0 1 1h.36c.455 0 .844-.311 1.03-.726.37-.833.982-1.626 1.732-2.353 2.354-2.28 3.878-5.547 3.878-8.69C27 6.507 21.998 2 16 2Zm5 25a1 1 0 0 0-1-1h-8a1 1 0 0 0-1 1 3 3 0 0 0 3 3h4a3 3 0 0 0 3-3Zm-8-13v1.5a.5.5 0 0 1-.5.5 1.5 1.5 0 0 1-1.5-1.5V14a1 1 0 1 1 2 0Zm6.5 2a.5.5 0 0 1-.5-.5V14a1 1 0 1 1 2 0v.5a1.5 1.5 0 0 1-1.5 1.5Z","fill":"url(#_S_4_-gradient-dark)"}]}]]}],["$","div",null,{"className":"ml-4 flex-auto","children":[["$","p",null,{"className":"not-prose font-display text-xl text-sky-900 dark:text-sky-400","children":"Note"}],["$","div",null,{"className":"prose mt-2.5 text-sky-800 [--tw-prose-background:var(--color-sky-50)] prose-a:text-sky-900 prose-code:text-sky-900 dark:text-slate-300 dark:prose-code:text-slate-300","children":["\n","$L31","\n","$L32","\n"]}]]}]]}]
1d:["$","h3",null,{"id":"test-vectors","children":[["$","a",null,{"aria-hidden":"true","tabIndex":"-1","href":"#test-vectors","children":["$","span",null,{"className":"icon icon-link"}]}],"Test Vectors"]}]
1e:["$","p",null,{"children":"TODO"}]
1f:["$","h2",null,{"id":"best-practices","children":[["$","a",null,{"aria-hidden":"true","tabIndex":"-1","href":"#best-practices","children":["$","span",null,{"className":"icon icon-link"}]}],"Best Practices"]}]
20:["$","p",null,{"children":"Since the account key pairs are derived from both the seed and the password, changing password after\nthe setup phase is not possible in this version of the Libernet wallet (a different password would\ndecode different accounts). The passwords are effectively part of the secret that allows recovering\nthe account keys, and must be treated as such. Implementors should never store these passwords\nanywhere and should clearly indicate to the user that they cannot be recovered."}]
21:["$","p",null,{"children":["It is possible to add new passwords by running a new ",["$","a",null,{"href":"#setup-phase","children":"setup phase"}]," with the existing\nseed. The new passwords will decode new accounts while the existing passwords will keep decoding the\nexisting accounts."]}]
22:["$","p",null,{"children":["Since we hard-coded a limit of 10 passwords per wallet, implementations ",["$","strong",null,{"children":"must never"}]," allow more,\nas doing so would invalidate plausible deniability by revealing that the user is using more than 10\npasswords."]}]
23:["$","p",null,{"children":["Never allow two or more identical passwords in the setup phase, as those would yield identical\nproofs in the ",["$","code",null,{"children":"y"}]," array and degrade plausible deniability by leaking information. For example, if\nthree elements of ",["$","code",null,{"children":"y"}]," are identical it means the user repeated the same password 3 times and is\nusing no more than 7 other passwords."]}]
24:["$","p",null,{"children":"Since the user is expected to remember all passwords, backing up the seed alone is sufficient to\nback up the entire wallet. When restoring a backup, implementors can run the setup phase asking the\nuser to provide all passwords. If one or more passwords can't be provided right away, a new setup\nphase can always be run later."}]
25:["$","p",null,{"children":"Even though the seed alone is insufficient to recover any account keys it's unadvisable to store it\nin cleartext when backing it up. The Argon2 key derivation function we use will resist dictionary\nand brute force attacks even if carried out by highly parallel actors equipped with GPU clusters,\nbut a targeted attack may use a relatively small dictionary and become successful (in layman's\nterms, someone who knows you well enough might just guess your password right)."}]
26:["$","$L33",null,{"children":["$","$34",null,{"name":"Next.MetadataOutlet","children":"$@35"}]}]
27:["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","msub",null,{"children":[["$","mi",null,{"children":"z"}],["$","mn",null,{"children":"1"}]]}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"z_1"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.5806em","verticalAlign":"-0.15em"}}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.04398em"},"children":"z"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.3011em"},"children":["$","span",null,{"style":{"top":"-2.55em","marginLeft":"-0.044em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mtight","children":"1"}]}]]}]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.15em"},"children":["$","span",null,{}]}]}]]}]}]]}]]}]}]]}]
28:["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"P"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"P"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.6833em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.13889em"},"children":"P"}]]}]}]]}]
29:["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"P"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"P"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.6833em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.13889em"},"children":"P"}]]}]}]]}]
2a:["$","span",null,{"className":"katex-display","children":["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","display":"block","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":[["$","mi",null,{"children":"α"}],["$","mo",null,{"children":"⋅"}],["$","mo",null,{"stretchy":"false","children":"("}],["$","mi",null,{"children":"x"}],["$","mo",null,{"children":"−"}],["$","msub",null,{"children":[["$","mi",null,{"children":"z"}],["$","mn",null,{"children":"0"}]]}],["$","mo",null,{"stretchy":"false","children":")"}],["$","mo",null,{"children":"⋅"}],["$","mo",null,{"stretchy":"false","children":"("}],["$","mi",null,{"children":"x"}],["$","mo",null,{"children":"−"}],["$","msub",null,{"children":[["$","mi",null,{"children":"z"}],["$","mn",null,{"children":"1"}]]}],["$","mo",null,{"stretchy":"false","children":")"}],["$","mo",null,{"children":"⋅"}],["$","mi",null,{"mathvariant":"normal","children":"."}],["$","mi",null,{"mathvariant":"normal","children":"."}],["$","mi",null,{"mathvariant":"normal","children":"."}],["$","mo",null,{"children":"⋅"}],["$","mo",null,{"stretchy":"false","children":"("}],["$","mi",null,{"children":"x"}],["$","mo",null,{"children":"−"}],["$","msub",null,{"children":[["$","mi",null,{"children":"z"}],["$","mn",null,{"children":"9"}]]}],["$","mo",null,{"stretchy":"false","children":")"}]]}],["$","annotation",null,{"encoding":"application/x-tex","children":"\\alpha \\cdot (x - z_0) \\cdot (x - z_1) \\cdot ... \\cdot (x - z_9)"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":[["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.4445em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.0037em"},"children":"α"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2222em"}}],["$","span",null,{"className":"mbin","children":"⋅"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2222em"}}]]}],["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1em","verticalAlign":"-0.25em"}}],["$","span",null,{"className":"mopen","children":"("}],["$","span",null,{"className":"mord mathnormal","children":"x"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2222em"}}],["$","span",null,{"className":"mbin","children":"−"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2222em"}}]]}],["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1em","verticalAlign":"-0.25em"}}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.04398em"},"children":"z"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.3011em"},"children":["$","span",null,{"style":{"top":"-2.55em","marginLeft":"-0.044em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mtight","children":"0"}]}]]}]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.15em"},"children":["$","span",null,{}]}]}]]}]}]]}],["$","span",null,{"className":"mclose","children":")"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2222em"}}],["$","span",null,{"className":"mbin","children":"⋅"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2222em"}}]]}],["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1em","verticalAlign":"-0.25em"}}],["$","span",null,{"className":"mopen","children":"("}],["$","span",null,{"className":"mord mathnormal","children":"x"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2222em"}}],["$","span",null,{"className":"mbin","children":"−"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2222em"}}]]}],["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1em","verticalAlign":"-0.25em"}}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.04398em"},"children":"z"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.3011em"},"children":["$","span",null,{"style":{"top":"-2.55em","marginLeft":"-0.044em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mtight","children":"1"}]}]]}]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],"$L36"]}]}]]}],"$L37","$L38","$L39","$L3a"]}],"$L3b","$L3c","$L3d"]}]]}]}]
2b:["$","p",null,{"children":["where ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"α"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"\\alpha"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.4306em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.0037em"},"children":"α"}]]}]}]]}]," is a random BLS scalar."]}]
2c:["$","li",null,{"children":["\n",["$","p",null,{"children":["Let ",["$","code",null,{"children":"c"}]," be the KZG commitment of ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"P"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"P"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.6833em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.13889em"},"children":"P"}]]}]}]]}]," over G1 and ",["$","code",null,{"children":"y"}]," the list of KZG proofs of the 10 root points\n",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":[["$","mo",null,{"stretchy":"false","children":"("}],["$","msub",null,{"children":[["$","mi",null,{"children":"z"}],["$","mi",null,{"children":"i"}]]}],["$","mo",null,{"separator":"true","children":","}],["$","mn",null,{"children":"0"}],["$","mo",null,{"stretchy":"false","children":")"}]]}],["$","annotation",null,{"encoding":"application/x-tex","children":"(z_i, 0)"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1em","verticalAlign":"-0.25em"}}],["$","span",null,{"className":"mopen","children":"("}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.04398em"},"children":"z"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.3117em"},"children":["$","span",null,{"style":{"top":"-2.55em","marginLeft":"-0.044em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mathnormal mtight","children":"i"}]}]]}]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.15em"},"children":["$","span",null,{}]}]}]]}]}]]}],["$","span",null,{"className":"mpunct","children":","}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.1667em"}}],["$","span",null,{"className":"mord","children":"0"}],["$","span",null,{"className":"mclose","children":")"}]]}]}]]}],"."]}],"\n"]}]
2d:["$","li",null,{"children":["\n",["$","p",null,{"children":["Shuffle the ",["$","code",null,{"children":"y"}]," list (you can use the ",["$","a",null,{"href":"https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle","children":"Fisher-Yates shuffle"}]," with a\nCSPRNG)."]}],"\n"]}]
2e:["$","li",null,{"children":["\n",["$","p",null,{"children":["Store ",["$","code",null,{"children":"s"}],", ",["$","code",null,{"children":"c"}],", and ",["$","code",null,{"children":"y"}]," to the wallet file."]}],"\n"]}]
2f:null
30:["\n",["$","p",null,{"children":["Step #8 is ",["$","strong",null,{"children":"very important"}]," to maintain plausible deniability. Don't store the proofs for the\nactual passwords first and those for the random keys last, for example. The order of the proofs\n",["$","strong",null,{"children":"must"}]," be randomized securely."]}],"\n"]
31:null
32:["\n",["$","p",null,{"children":["To prevent timing attacks the algorithm at point #3 must run in constant time, therefore\nimplementors must check ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"z"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"z"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.4306em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.04398em"},"children":"z"}]]}]}]]}]," against ",["$","strong",null,{"children":"all"}]," 10 proofs even if one succeeds before checking the\nlast."]}],"\n"]
35:null
36:["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.15em"},"children":["$","span",null,{}]}]}]
37:["$","span",null,{"className":"mclose","children":")"}]
38:["$","span",null,{"className":"mspace","style":{"marginRight":"0.2222em"}}]
39:["$","span",null,{"className":"mbin","children":"⋅"}]
3a:["$","span",null,{"className":"mspace","style":{"marginRight":"0.2222em"}}]
3b:["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.4445em"}}],["$","span",null,{"className":"mord","children":"..."}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2222em"}}],["$","span",null,{"className":"mbin","children":"⋅"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2222em"}}]]}]
3c:["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1em","verticalAlign":"-0.25em"}}],["$","span",null,{"className":"mopen","children":"("}],["$","span",null,{"className":"mord mathnormal","children":"x"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2222em"}}],["$","span",null,{"className":"mbin","children":"−"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2222em"}}]]}]
3d:["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1em","verticalAlign":"-0.25em"}}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.04398em"},"children":"z"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.3011em"},"children":["$","span",null,{"style":{"top":"-2.55em","marginLeft":"-0.044em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mtight","children":"9"}]}]]}]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.15em"},"children":["$","span",null,{}]}]}]]}]}]]}],["$","span",null,{"className":"mclose","children":")"}]]}]
