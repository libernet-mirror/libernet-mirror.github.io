<!DOCTYPE html><!--XqGjjMBGxejP92vqRqytZ--><html lang="en" class="h-full antialiased inter_2fe1ab3d-module__-T-KAq__variable lexend_b0aebfd3-module__hhPs7G__variable"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/chunks/ea40ae979bfe4280.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/945fab894dcb74b9.js"/><script src="/_next/static/chunks/4745b59d0a053e7f.js" async=""></script><script src="/_next/static/chunks/557be5c833d730fe.js" async=""></script><script src="/_next/static/chunks/73a330e38f4c895c.js" async=""></script><script src="/_next/static/chunks/turbopack-36816986c202153c.js" async=""></script><script src="/_next/static/chunks/5ea14be58487f1ab.js" async=""></script><script src="/_next/static/chunks/68246509281fa544.js" async=""></script><script src="/_next/static/chunks/ff1a16fafef87110.js" async=""></script><script src="/_next/static/chunks/247eb132b7f7b574.js" async=""></script><script src="/_next/static/chunks/8a9742a9e956ace0.js" async=""></script><link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex.min.css" as="style" crossorigin="anonymous" integrity="sha384-WcoG4HRXMzYzfCgiyfrySxx90XSl2rxY5mnVY5TwtWE6KLrArNKn0T/mOgNL0Mmi"/><meta name="next-size-adjust" content=""/><title>Libernet Documentation</title><meta name="description" content="Libernet Documentation"/><link rel="author" href="https://libernet.xyz"/><meta name="author" content="The Libernet team"/><link rel="icon" href="/_next/static/media/favicon.9a94e18a.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex.min.css" integrity="sha384-WcoG4HRXMzYzfCgiyfrySxx90XSl2rxY5mnVY5TwtWE6KLrArNKn0T/mOgNL0Mmi" crossorigin="anonymous"/><script src="/_next/static/chunks/a6dad97d9634a72d.js" noModule=""></script></head><body class="flex min-h-full bg-white dark:bg-slate-900"><div hidden=""><!--$--><!--/$--></div><script>((a,b,c,d,e,f,g,h)=>{let i=document.documentElement,j=["light","dark"];function k(b){var c;(Array.isArray(a)?a:[a]).forEach(a=>{let c="class"===a,d=c&&f?e.map(a=>f[a]||a):e;c?(i.classList.remove(...d),i.classList.add(f&&f[b]?f[b]:b)):i.setAttribute(a,b)}),c=b,h&&j.includes(c)&&(i.style.colorScheme=c)}if(d)k(d);else try{let a=localStorage.getItem(b)||c,d=g&&"system"===a?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":a;k(d)}catch(a){}})("class","theme","system",null,["light","dark"],null,true,true)</script><div class="flex w-full flex-col"><header class="sticky top-0 z-50 flex flex-none flex-wrap items-center justify-between bg-white px-4 py-5 shadow-md shadow-slate-900/5 transition duration-500 sm:px-6 lg:px-8 dark:shadow-none dark:bg-transparent"><div class="mr-6 flex lg:hidden"><button type="button" class="relative"><svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" class="h-6 w-6 stroke-slate-500"><path d="M4 7h16M4 12h16M4 17h16"></path></svg></button><!--$!--><template data-dgst="BAILOUT_TO_CLIENT_SIDE_RENDERING"></template><!--/$--><span hidden="" style="position:fixed;top:1px;left:1px;width:1px;height:0;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0;display:none"></span></div><div class="relative flex grow basis-0 items-center"><a href="/"><img alt="Libernet" loading="lazy" width="36" height="36" decoding="async" data-nimg="1" class="h-9 w-9 lg:hidden" style="color:transparent" src="/_next/static/media/logo.6834dc1e.svg"/><img alt="Libernet" loading="lazy" width="36" height="36" decoding="async" data-nimg="1" class="hidden h-9 w-auto fill-slate-700 lg:block dark:fill-sky-100" style="color:transparent" src="/_next/static/media/logo.6834dc1e.svg"/></a></div><div class="-my-5 mr-6 sm:mr-8 md:mr-0"></div><div class="relative flex basis-0 justify-end gap-6 sm:gap-8 md:grow"><div class="relative z-10" data-headlessui-state=""><div class="sr-only" id="headlessui-label-_R_3dhlb_" data-headlessui-state="">Theme</div><button class="flex h-6 w-6 items-center justify-center rounded-lg shadow-md ring-1 shadow-black/5 ring-black/5 dark:bg-slate-700 dark:ring-white/5 dark:ring-inset" id="headlessui-listbox-button-_R_5dhlb_" type="button" aria-haspopup="listbox" aria-expanded="false" data-headlessui-state=""><svg viewBox="0 0 16 16" class="h-4 w-4 dark:hidden fill-sky-400"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 1a1 1 0 0 1 2 0v1a1 1 0 1 1-2 0V1Zm4 7a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm2.657-5.657a1 1 0 0 0-1.414 0l-.707.707a1 1 0 0 0 1.414 1.414l.707-.707a1 1 0 0 0 0-1.414Zm-1.415 11.313-.707-.707a1 1 0 0 1 1.415-1.415l.707.708a1 1 0 0 1-1.415 1.414ZM16 7.999a1 1 0 0 0-1-1h-1a1 1 0 1 0 0 2h1a1 1 0 0 0 1-1ZM7 14a1 1 0 1 1 2 0v1a1 1 0 1 1-2 0v-1Zm-2.536-2.464a1 1 0 0 0-1.414 0l-.707.707a1 1 0 0 0 1.414 1.414l.707-.707a1 1 0 0 0 0-1.414Zm0-8.486A1 1 0 0 1 3.05 4.464l-.707-.707a1 1 0 0 1 1.414-1.414l.707.707ZM3 8a1 1 0 0 0-1-1H1a1 1 0 0 0 0 2h1a1 1 0 0 0 1-1Z"></path></svg><svg viewBox="0 0 16 16" class="hidden h-4 w-4 dark:block fill-sky-400"><path fill-rule="evenodd" clip-rule="evenodd" d="M7.23 3.333C7.757 2.905 7.68 2 7 2a6 6 0 1 0 0 12c.68 0 .758-.905.23-1.332A5.989 5.989 0 0 1 5 8c0-1.885.87-3.568 2.23-4.668ZM12 5a1 1 0 0 1 1 1 1 1 0 0 0 1 1 1 1 0 1 1 0 2 1 1 0 0 0-1 1 1 1 0 1 1-2 0 1 1 0 0 0-1-1 1 1 0 1 1 0-2 1 1 0 0 0 1-1 1 1 0 0 1 1-1Z"></path></svg></button></div><a class="group" href="https://github.com/libernet-mirror/libernet-mirror.github.io"><svg aria-hidden="true" viewBox="0 0 16 16" class="h-6 w-6 fill-slate-400 group-hover:fill-slate-500 dark:group-hover:fill-slate-300"><path d="M8 0C3.58 0 0 3.58 0 8C0 11.54 2.29 14.53 5.47 15.59C5.87 15.66 6.02 15.42 6.02 15.21C6.02 15.02 6.01 14.39 6.01 13.72C4 14.09 3.48 13.23 3.32 12.78C3.23 12.55 2.84 11.84 2.5 11.65C2.22 11.5 1.82 11.13 2.49 11.12C3.12 11.11 3.57 11.7 3.72 11.94C4.44 13.15 5.59 12.81 6.05 12.6C6.12 12.08 6.33 11.73 6.56 11.53C4.78 11.33 2.92 10.64 2.92 7.58C2.92 6.71 3.23 5.99 3.74 5.43C3.66 5.23 3.38 4.41 3.82 3.31C3.82 3.31 4.49 3.1 6.02 4.13C6.66 3.95 7.34 3.86 8.02 3.86C8.7 3.86 9.38 3.95 10.02 4.13C11.55 3.09 12.22 3.31 12.22 3.31C12.66 4.41 12.38 5.23 12.3 5.43C12.81 5.99 13.12 6.7 13.12 7.58C13.12 10.65 11.25 11.33 9.47 11.53C9.76 11.78 10.01 12.26 10.01 13.01C10.01 14.08 10 14.94 10 15.21C10 15.42 10.15 15.67 10.55 15.59C13.71 14.53 16 11.53 16 8C16 3.58 12.42 0 8 0Z"></path></svg></a></div></header><div class="max-w-8xl relative mx-auto flex w-full flex-auto justify-center sm:px-2 lg:px-8 xl:px-12"><div class="hidden lg:relative lg:block lg:flex-none"><div class="absolute inset-y-0 right-0 w-[50vw] bg-slate-50 dark:hidden"></div><div class="absolute top-16 right-0 bottom-0 hidden h-12 w-px bg-linear-to-t from-slate-800 dark:block"></div><div class="absolute top-28 right-0 bottom-0 hidden w-px bg-slate-800 dark:block"></div><div class="sticky top-19 -ml-0.5 h-[calc(100vh-4.75rem)] w-64 overflow-x-hidden overflow-y-auto py-16 pr-8 pl-0.5 xl:w-72 xl:pr-16"><nav class="text-base lg:text-sm"><ul role="list" class="space-y-9"><li><h2 class="font-display font-medium text-slate-900 dark:text-white">Introduction</h2><ul role="list" class="mt-2 space-y-2 border-l-2 border-slate-100 lg:mt-4 lg:space-y-4 lg:border-slate-200 dark:border-slate-800"><li class="relative"><a class="block w-full pl-3.5 before:pointer-events-none before:absolute before:top-1/2 before:-left-1 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300" href="/">Introduction</a></li></ul></li><li><h2 class="font-display font-medium text-slate-900 dark:text-white">User Guides</h2><ul role="list" class="mt-2 space-y-2 border-l-2 border-slate-100 lg:mt-4 lg:space-y-4 lg:border-slate-200 dark:border-slate-800"><li class="relative"><a class="block w-full pl-3.5 before:pointer-events-none before:absolute before:top-1/2 before:-left-1 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300" href="/user/getting-started">Getting Started</a></li><li class="relative"><a class="block w-full pl-3.5 before:pointer-events-none before:absolute before:top-1/2 before:-left-1 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300" href="/user/node-turnup">Node Turnup</a></li></ul></li><li><h2 class="font-display font-medium text-slate-900 dark:text-white">Developer Guides</h2><ul role="list" class="mt-2 space-y-2 border-l-2 border-slate-100 lg:mt-4 lg:space-y-4 lg:border-slate-200 dark:border-slate-800"><li class="relative"><a class="block w-full pl-3.5 before:pointer-events-none before:absolute before:top-1/2 before:-left-1 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300" href="/dev/architecture">Architecture</a></li><li class="relative"><a class="block w-full pl-3.5 before:pointer-events-none before:absolute before:top-1/2 before:-left-1 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300" href="/dev/protocol">Wire Protocol</a></li><li class="relative"><a class="block w-full pl-3.5 before:pointer-events-none before:absolute before:top-1/2 before:-left-1 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full font-semibold text-sky-500 before:bg-sky-500" href="/dev/wallet/v1">Wallet Format V1</a></li><li class="relative"><a class="block w-full pl-3.5 before:pointer-events-none before:absolute before:top-1/2 before:-left-1 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300" href="/dev/plonk">zkSNARKs and PLONK</a></li></ul></li></ul></nav></div></div><div class="max-w-2xl min-w-0 flex-auto px-4 py-16 lg:max-w-none lg:pr-0 lg:pl-8 xl:px-16"><article><header class="mb-9 space-y-1"><p class="font-display text-sm font-medium text-sky-500">Developer Guides</p><h1 class="font-display text-3xl tracking-tight text-slate-900 dark:text-white">Wallet Format V1</h1></header><div class="prose prose-slate dark:prose-invert max-w-none dark:text-slate-400 prose-headings:scroll-mt-28 prose-headings:font-display prose-headings:font-normal lg:prose-headings:scroll-mt-34 prose-lead:text-slate-500 dark:prose-lead:text-slate-400 prose-a:font-semibold dark:prose-a:text-sky-400 prose-a:no-underline prose-a:shadow-[inset_0_-2px_0_0_var(--tw-prose-background,#fff),inset_0_calc(-1*(var(--tw-prose-underline-size,4px)+2px))_0_0_var(--tw-prose-underline,var(--color-sky-300))] prose-a:hover:[--tw-prose-underline-size:6px] dark:prose-a:shadow-[inset_0_calc(-1*var(--tw-prose-underline-size,2px))_0_0_var(--tw-prose-underline,var(--color-sky-800))] dark:prose-a:hover:[--tw-prose-underline-size:6px] dark:[--tw-prose-background:var(--color-slate-900)] prose-pre:rounded-xl prose-pre:bg-slate-900 prose-pre:shadow-lg dark:prose-pre:bg-slate-800/60 dark:prose-pre:shadow-none dark:prose-pre:ring-1 dark:prose-pre:ring-slate-300/10 dark:prose-hr:border-slate-800"><h2 id="overview"><a aria-hidden="true" tabindex="-1" href="#overview"><span class="icon icon-link"></span></a>Overview</h2>
<p>This page specifies the file format used to store Libernet wallets and the process to derive the
actual accounts of a wallet.</p>
<h2 id="anatomy-of-an-account"><a aria-hidden="true" tabindex="-1" href="#anatomy-of-an-account"><span class="icon icon-link"></span></a>Anatomy of an Account</h2>
<p>An account is a <a href="https://hackmd.io/@benjaminion/bls12-381">BLS12-381</a> key pair that can be used to sign Libernet transactions. On
the public ledger, accounts are known by their <em>address</em>, which is computed using the SHA3 hash of
the public BLS key (see the following sections for the exact procedure).</p>
<p>Example account:</p>
<ul>
<li>private BLS key scalar (32 bytes): <code>0x2dde5ffbbc881910a9b1cc9567eae3c1e3f8563f4e2771eb9957ead7b7d6a3c5</code></li>
<li>public BLS key point in compressed form (48 bytes): <code>0xaa4130eebea382e2c4312186290585d620b858c41a4316d8b62beacb0a443690d7d751ddd7b12eaa58470d29a0bf468b</code></li>
<li>account address (a BLS scalar computed from the SHA3 hash of the public key): <code>0x210b0a3a23416f66a210531ec98db0fc39162b288f48de9289a6186af4f3eba1</code></li>
</ul>
<div class="my-8 flex rounded-3xl p-6 bg-amber-50 dark:bg-slate-800/60 dark:ring-1 dark:ring-slate-300/10"><svg viewBox="0 0 32 32" fill="none" class="h-8 w-8 flex-none [--icon-foreground:var(--color-amber-900)] [--icon-background:var(--color-amber-100)]"><defs><radialGradient cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" id="_S_1_-gradient" gradientTransform="rotate(65.924 1.519 20.92) scale(25.7391)"><stop stop-color="#FDE68A" offset=".08"></stop><stop stop-color="#F59E0B" offset=".837"></stop></radialGradient><radialGradient cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" id="_S_1_-gradient-dark" gradientTransform="matrix(0 24.5 -24.5 0 16 5.5)"><stop stop-color="#FDE68A" offset=".08"></stop><stop stop-color="#F59E0B" offset=".837"></stop></radialGradient></defs><g class="dark:hidden"><circle cx="20" cy="20" r="12" fill="url(#_S_1_-gradient)"></circle><path d="M3 16c0 7.18 5.82 13 13 13s13-5.82 13-13S23.18 3 16 3 3 8.82 3 16Z" fill-opacity="0.5" class="fill-(--icon-background) stroke-(--icon-foreground)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path><path d="m15.408 16.509-1.04-5.543a1.66 1.66 0 1 1 3.263 0l-1.039 5.543a.602.602 0 0 1-1.184 0Z" class="fill-(--icon-foreground) stroke-(--icon-foreground)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path><path d="M16 23a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z" fill-opacity="0.5" stroke="currentColor" class="fill-(--icon-background) stroke-(--icon-foreground)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g><g class="hidden dark:inline"><path fill-rule="evenodd" clip-rule="evenodd" d="M2 16C2 8.268 8.268 2 16 2s14 6.268 14 14-6.268 14-14 14S2 23.732 2 16Zm11.386-4.85a2.66 2.66 0 1 1 5.228 0l-1.039 5.543a1.602 1.602 0 0 1-3.15 0l-1.04-5.543ZM16 20a2 2 0 1 0 0 4 2 2 0 0 0 0-4Z" fill="url(#_S_1_-gradient-dark)"></path></g></svg><div class="ml-4 flex-auto"><p class="not-prose font-display text-xl text-amber-900 dark:text-amber-500">Warning</p><div class="prose mt-2.5 text-amber-800 [--tw-prose-underline:var(--color-amber-400)] [--tw-prose-background:var(--color-amber-50)] prose-a:text-amber-900 prose-code:text-amber-900 dark:text-slate-300 dark:[--tw-prose-underline:var(--color-sky-700)] dark:prose-code:text-slate-300">
<!-- -->
<!-- -->
<p>Do not use the account above, it&#x27;s leaked. Any assets transferred to this account will be
<strong>permanently lost</strong>.</p>
<!-- -->
</div></div></div>
<p>The public ledger associates LIB balances and other assets to account addresses, and the protocol
grants ownership of such assets to the key pair whose public key hashes to the corresponding
address.</p>
<h2 id="wallet-features"><a aria-hidden="true" tabindex="-1" href="#wallet-features"><span class="icon icon-link"></span></a>Wallet Features</h2>
<p>A single wallet file can derive an unlimited number of accounts. These accounts are completely
independent of each other, meaning it&#x27;s infeasible for any external actors to determine whether any
two given accounts were generated from the same wallet.</p>
<p>Wallets have a seed and one or more associated passwords (up to 10). The algorithm to derive an
actual account key pair uses the seed and one of the passwords. As a result, different passwords
will generate completely different accounts, and this is the basis for Libernet&#x27;s plausible
deniability scheme.</p>
<p>The seed of a wallet is stored in cleartext in the wallet file, while the passwords are never stored
directly. Instead, we use the <a href="https://dankradfeist.de/ethereum/2020/06/16/kate-polynomial-commitments.html">KZG polynomial commitment scheme</a> to commit to them and check
password correctness when a user wants to unlock a wallet.</p>
<h2 id="wallet-format"><a aria-hidden="true" tabindex="-1" href="#wallet-format"><span class="icon icon-link"></span></a>Wallet Format</h2>
<p>A version 1 Libernet wallet file is a <a href="https://www.json.org/">JSON</a> file with the following fields:</p>
<ul>
<li><code>version</code> must be the string <code>1.0</code>.</li>
<li><code>seed</code> is a 64-byte random number stored as a string in lower-case hex format prefixed with <code>0x</code>,
e.g. <code>0x4bbda518f23220af8eb7e8324cf132c0733b9c876c8e3112c69a27b779d22bf8bb7d089e1ef1706772abd511fc5b45f654e9fcb31fe30875bd6ff0648585cf92</code>.</li>
<li><code>c</code> is a BLS point over G1 in compressed format (48 bytes), stored as a string in lower-case hex
format prefixed with <code>0x</code>.</li>
<li><code>y</code> is an array containing exactly 10 BLS points over G1, each having the same format as <code>c</code>.</li>
</ul>
<p>Example wallet:</p>
<div class="my-8 flex rounded-3xl p-6 bg-amber-50 dark:bg-slate-800/60 dark:ring-1 dark:ring-slate-300/10"><svg viewBox="0 0 32 32" fill="none" class="h-8 w-8 flex-none [--icon-foreground:var(--color-amber-900)] [--icon-background:var(--color-amber-100)]"><defs><radialGradient cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" id="_S_2_-gradient" gradientTransform="rotate(65.924 1.519 20.92) scale(25.7391)"><stop stop-color="#FDE68A" offset=".08"></stop><stop stop-color="#F59E0B" offset=".837"></stop></radialGradient><radialGradient cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" id="_S_2_-gradient-dark" gradientTransform="matrix(0 24.5 -24.5 0 16 5.5)"><stop stop-color="#FDE68A" offset=".08"></stop><stop stop-color="#F59E0B" offset=".837"></stop></radialGradient></defs><g class="dark:hidden"><circle cx="20" cy="20" r="12" fill="url(#_S_2_-gradient)"></circle><path d="M3 16c0 7.18 5.82 13 13 13s13-5.82 13-13S23.18 3 16 3 3 8.82 3 16Z" fill-opacity="0.5" class="fill-(--icon-background) stroke-(--icon-foreground)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path><path d="m15.408 16.509-1.04-5.543a1.66 1.66 0 1 1 3.263 0l-1.039 5.543a.602.602 0 0 1-1.184 0Z" class="fill-(--icon-foreground) stroke-(--icon-foreground)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path><path d="M16 23a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z" fill-opacity="0.5" stroke="currentColor" class="fill-(--icon-background) stroke-(--icon-foreground)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g><g class="hidden dark:inline"><path fill-rule="evenodd" clip-rule="evenodd" d="M2 16C2 8.268 8.268 2 16 2s14 6.268 14 14-6.268 14-14 14S2 23.732 2 16Zm11.386-4.85a2.66 2.66 0 1 1 5.228 0l-1.039 5.543a1.602 1.602 0 0 1-3.15 0l-1.04-5.543ZM16 20a2 2 0 1 0 0 4 2 2 0 0 0 0-4Z" fill="url(#_S_2_-gradient-dark)"></path></g></svg><div class="ml-4 flex-auto"><p class="not-prose font-display text-xl text-amber-900 dark:text-amber-500">Warning</p><div class="prose mt-2.5 text-amber-800 [--tw-prose-underline:var(--color-amber-400)] [--tw-prose-background:var(--color-amber-50)] prose-a:text-amber-900 prose-code:text-amber-900 dark:text-slate-300 dark:[--tw-prose-underline:var(--color-sky-700)] dark:prose-code:text-slate-300">
<!-- -->
<!-- -->
<p>Do not use the following wallet, it&#x27;s leaked.</p>
<!-- -->
</div></div></div>
<div class="remark-highlight"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.0&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;seed&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0x4bbda518f23220af8eb7e8324cf132c0733b9c876c8e3112c69a27b779d22bf8bb7d089e1ef1706772abd511fc5b45f654e9fcb31fe30875bd6ff0648585cf92&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;c&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0x801779b8613e11f65317ccdb11c950461b9c305276e06d65316d66322b23d85088a0e9b68381a4531d970062345825e7&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;y&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;0xb466b114add86cef49255e1479436eb4fe49798dbb7573bbf073cb8b9ceee5bf09d3e2465fec4fb9d7819bff62288373&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;0x8de02594854b5ce06126cdfb0984be3d0b9bc162236c1221f951c358f160d1063397a2e9496366eb4d5c876946234a40&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;0x900b96dbccd6309840fa075ce54d61a25c212076c329cbdc425e3dbe74380ced054960d144560903112b3ed53ff96d03&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;0xa4fbeb582ce042e4e9f37db0eca05a1b47293873dc12fd2901dd4822f9017ecf57bf6169af8121daf67755661c18393e&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;0x83332293c2508f407a4c56792e4e6f06f209bb7751ce0f738c379548fbf9e1f76adfd6f11fc40885a0538f6893683a36&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;0x881cded5f5efcf4c1618b727bdcc6ecf509a658b7e422b556feab0df4948012a7e65cd89f25bf62f81529136baee0630&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;0x858c616dad16af911b8afad048de067c5f8e092f82d895f2b0a0f8f0a211a84ff39ce5545d2b7e01becea48fc96b425e&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;0xb30942bb2f1a7bfc90bbbd9a0b23fe1b08478ad38fab2ed7bcd75c6785f3d2f6d6e6e5e59cececacece4376922ad30a8&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;0x87abdc824b25ec12162b3062217e5216c624d15a050ccd4d6cc2ad3f9b13f7c9dbda05f9114e49b922bad788e2e5c825&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;0x85d650e5a5c1ea3ebf4d575f143251158600c4c3bfd2e0fbbc883dd7d1d40f5ca9ddbb91efc3eed5825e62814150a1a8&quot;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div>
<h2 id="derivation-algorithm"><a aria-hidden="true" tabindex="-1" href="#derivation-algorithm"><span class="icon icon-link"></span></a>Derivation Algorithm</h2>
<h3 id="general-notes"><a aria-hidden="true" tabindex="-1" href="#general-notes"><span class="icon icon-link"></span></a>General Notes</h3>
<p>In the following algorithm we perform modular reduction from 512-bit integers to BLS scalars every
time we need to switch to algebraic cryptography, e.g. when converting a SHA3 hash to a scalar. The
reason why we use 512-bit cryptography despite 256 bits being generally considered safe is to
warrant a uniform distribution of the resulting scalar.</p>
<p>The order of the BLS12-381 scalar field is the following ~255-bit prime number:</p>
<div class="remark-highlight"><pre class="language-unknown"><code class="language-unknown">r = 0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001</code></pre></div>
<p>Note that the first few nibbles are <code>73ed...</code>, so this value is roughly 0.45 times the full 256-bit
range. Performing modular reduction from the 256-bit range to the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span></span></span> range would result in a
visible skew of the distribution, as ~10% of the values would become 50% more frequent.</p>
<p>On the other hand, the 512-bit range is astronomically larger than <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span></span></span> (more than <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>256</mn></msup></mrow><annotation encoding="application/x-tex">2^{256}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">256</span></span></span></span></span></span></span></span></span></span></span></span> times
larger), so in this case the distribution bias resulting from modular reduction is virtually
non-existent.</p>
<p>None of the 512-bit values we use in this type of conversion have endianness, so we always assume
<strong>little endian order</strong>.</p>
<h3 id="setup-phase"><a aria-hidden="true" tabindex="-1" href="#setup-phase"><span class="icon icon-link"></span></a>Setup Phase</h3>
<ol>
<li>
<p>Generate the 64-byte seed using a CSPRNG. Let <code>s</code> be this seed.</p>
</li>
<li>
<p>Let the user enter at least one and at most 10 different passwords. Error out if two or more
passwords are identical.</p>
</li>
<li>
<p>Derive a 64-byte key for each password using the <a href="https://en.wikipedia.org/wiki/Argon2">Argon2id</a> key derivation function with
the following parameters:</p>
<ul>
<li>algorithm version: 19 (0x13)</li>
<li>M cost: 256 * 1024 (= 256 MiB)</li>
<li>T cost: 2</li>
<li>P cost: 1</li>
<li>salt: the seed <code>s</code></li>
<li>output length: 64 bytes</li>
</ul>
<p>The passwords must be encoded in UTF-8.</p>
</li>
<li>
<p>If the user provided less than 10 passwords, add more randomly generated 64-byte keys until there
are 10 keys in total. All random keys must be generated by a CSPRNG.</p>
</li>
<li>
<p>Convert the 10 keys to corresponding BLS scalars via modular reduction. Let <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">z_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> be the <em>i</em>-th
scalar.</p>
</li>
<li>
<p>Compute a polynomial whose roots are the 10 scalars <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">z_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">z_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span>, etc. Let <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span></span></span></span> be this
polynomial. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span></span></span></span> can be computed as:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>α</mi><mo>⋅</mo><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><msub><mi>z</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo>⋅</mo><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><msub><mi>z</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>⋅</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>⋅</mo><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><msub><mi>z</mi><mn>9</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\alpha \cdot (x - z_0) \cdot (x - z_1) \cdot ... \cdot (x - z_9)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4445em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.4445em"></span><span class="mord">...</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>
<p>where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span></span></span></span> is a random BLS scalar.</p>
</li>
<li>
<p>Let <code>c</code> be the KZG commitment of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span></span></span></span> over G1 and <code>y</code> the list of KZG proofs of the 10 root points
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(z_i, 0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span>.</p>
</li>
<li>
<p>Shuffle the <code>y</code> list (you can use the <a href="https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle">Fisher-Yates shuffle</a> with a
CSPRNG).</p>
</li>
<li>
<p>Store <code>s</code>, <code>c</code>, and <code>y</code> to the wallet file.</p>
</li>
</ol>
<div class="my-8 flex rounded-3xl p-6 bg-sky-50 dark:bg-slate-800/60 dark:ring-1 dark:ring-slate-300/10"><svg viewBox="0 0 32 32" fill="none" class="h-8 w-8 flex-none [--icon-foreground:var(--color-slate-900)] [--icon-background:var(--color-white)]"><defs><radialGradient cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" id="_S_3_-gradient" gradientTransform="matrix(0 21 -21 0 20 11)"><stop stop-color="#0EA5E9"></stop><stop stop-color="#22D3EE" offset=".527"></stop><stop stop-color="#818CF8" offset="1"></stop></radialGradient><radialGradient cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" id="_S_3_-gradient-dark" gradientTransform="matrix(0 24.5001 -19.2498 0 16 5.5)"><stop stop-color="#0EA5E9"></stop><stop stop-color="#22D3EE" offset=".527"></stop><stop stop-color="#818CF8" offset="1"></stop></radialGradient></defs><g class="dark:hidden"><circle cx="20" cy="20" r="12" fill="url(#_S_3_-gradient)"></circle><path fill-rule="evenodd" clip-rule="evenodd" d="M20 24.995c0-1.855 1.094-3.501 2.427-4.792C24.61 18.087 26 15.07 26 12.231 26 7.133 21.523 3 16 3S6 7.133 6 12.23c0 2.84 1.389 5.857 3.573 7.973C10.906 21.494 12 23.14 12 24.995V27a2 2 0 0 0 2 2h4a2 2 0 0 0 2-2v-2.005Z" class="fill-(--icon-background)" fill-opacity="0.5"></path><path d="M25 12.23c0 2.536-1.254 5.303-3.269 7.255l1.391 1.436c2.354-2.28 3.878-5.547 3.878-8.69h-2ZM16 4c5.047 0 9 3.759 9 8.23h2C27 6.508 21.998 2 16 2v2Zm-9 8.23C7 7.76 10.953 4 16 4V2C10.002 2 5 6.507 5 12.23h2Zm3.269 7.255C8.254 17.533 7 14.766 7 12.23H5c0 3.143 1.523 6.41 3.877 8.69l1.392-1.436ZM13 27v-2.005h-2V27h2Zm1 1a1 1 0 0 1-1-1h-2a3 3 0 0 0 3 3v-2Zm4 0h-4v2h4v-2Zm1-1a1 1 0 0 1-1 1v2a3 3 0 0 0 3-3h-2Zm0-2.005V27h2v-2.005h-2ZM8.877 20.921C10.132 22.136 11 23.538 11 24.995h2c0-2.253-1.32-4.143-2.731-5.51L8.877 20.92Zm12.854-1.436C20.32 20.852 19 22.742 19 24.995h2c0-1.457.869-2.859 2.122-4.074l-1.391-1.436Z" class="fill-(--icon-foreground)"></path><path d="M20 26a1 1 0 1 0 0-2v2Zm-8-2a1 1 0 1 0 0 2v-2Zm2 0h-2v2h2v-2Zm1 1V13.5h-2V25h2Zm-5-11.5v1h2v-1h-2Zm3.5 4.5h5v-2h-5v2Zm8.5-3.5v-1h-2v1h2ZM20 24h-2v2h2v-2Zm-2 0h-4v2h4v-2Zm-1-10.5V25h2V13.5h-2Zm2.5-2.5a2.5 2.5 0 0 0-2.5 2.5h2a.5.5 0 0 1 .5-.5v-2Zm2.5 2.5a2.5 2.5 0 0 0-2.5-2.5v2a.5.5 0 0 1 .5.5h2ZM18.5 18a3.5 3.5 0 0 0 3.5-3.5h-2a1.5 1.5 0 0 1-1.5 1.5v2ZM10 14.5a3.5 3.5 0 0 0 3.5 3.5v-2a1.5 1.5 0 0 1-1.5-1.5h-2Zm2.5-3.5a2.5 2.5 0 0 0-2.5 2.5h2a.5.5 0 0 1 .5-.5v-2Zm2.5 2.5a2.5 2.5 0 0 0-2.5-2.5v2a.5.5 0 0 1 .5.5h2Z" class="fill-(--icon-foreground)"></path></g><g class="hidden dark:inline"><path fill-rule="evenodd" clip-rule="evenodd" d="M16 2C10.002 2 5 6.507 5 12.23c0 3.144 1.523 6.411 3.877 8.691.75.727 1.363 1.52 1.734 2.353.185.415.574.726 1.028.726H12a1 1 0 0 0 1-1v-4.5a.5.5 0 0 0-.5-.5A3.5 3.5 0 0 1 9 14.5V14a3 3 0 1 1 6 0v9a1 1 0 1 0 2 0v-9a3 3 0 1 1 6 0v.5a3.5 3.5 0 0 1-3.5 3.5.5.5 0 0 0-.5.5V23a1 1 0 0 0 1 1h.36c.455 0 .844-.311 1.03-.726.37-.833.982-1.626 1.732-2.353 2.354-2.28 3.878-5.547 3.878-8.69C27 6.507 21.998 2 16 2Zm5 25a1 1 0 0 0-1-1h-8a1 1 0 0 0-1 1 3 3 0 0 0 3 3h4a3 3 0 0 0 3-3Zm-8-13v1.5a.5.5 0 0 1-.5.5 1.5 1.5 0 0 1-1.5-1.5V14a1 1 0 1 1 2 0Zm6.5 2a.5.5 0 0 1-.5-.5V14a1 1 0 1 1 2 0v.5a1.5 1.5 0 0 1-1.5 1.5Z" fill="url(#_S_3_-gradient-dark)"></path></g></svg><div class="ml-4 flex-auto"><p class="not-prose font-display text-xl text-sky-900 dark:text-sky-400">Note</p><div class="prose mt-2.5 text-sky-800 [--tw-prose-background:var(--color-sky-50)] prose-a:text-sky-900 prose-code:text-sky-900 dark:text-slate-300 dark:prose-code:text-slate-300">
<!-- -->
<!-- -->
<p>Step #8 is <strong>very important</strong> to maintain plausible deniability. Don&#x27;t store the proofs for the
actual passwords first and those for the random keys last, for example. The order of the proofs
<strong>must</strong> be randomized securely.</p>
<!-- -->
</div></div></div>
<h3 id="unlock-phase"><a aria-hidden="true" tabindex="-1" href="#unlock-phase"><span class="icon icon-link"></span></a>Unlock Phase</h3>
<ol>
<li>
<p>Let the user enter a password, encode it in UTF-8, and derive the corresponding Argon2id key
using the parameters above.</p>
</li>
<li>
<p>Convert the 64-byte Argon2id key to a BLS scalar via modular reduction. Let <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.04398em">z</span></span></span></span> be this scalar.</p>
</li>
<li>
<p>For each KZG proof in the <code>y</code> array:</p>
<ul>
<li>if the proof successfully verifies that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.04398em">z</span></span></span></span> is a root of the polynomial commited to by <code>c</code>,
then the password is correct;</li>
<li>if none of the proofs work, show an invalid password error message and exit.</li>
</ul>
</li>
<li>
<p>To compute the private BLS key of the <em>i</em>-th account:</p>
<ul>
<li>Let <code>H</code> be the SHA3-512 hash of a 104-byte message built as follows:<!-- -->
<ul>
<li>the first 64 bytes are the seed <code>s</code>,</li>
<li>the next 32 bytes are the key scalar <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.04398em">z</span></span></span></span> in little endian order,</li>
<li>the final 8 bytes are the index <code>i</code> in little endian order.</li>
</ul>
</li>
<li>Convert <code>H</code> to a BLS scalar via modular reduction. The scalar is the private key.</li>
</ul>
</li>
<li>
<p>The public BLS key is computed over G1 as usual (ECC multiplication by the G1 generator point).</p>
</li>
<li>
<p>The account address is obtained by computing the SHA3-512 hash of the public key point in
compressed form (48 bytes) and converting the hash to a BLS scalar via modular reduction.</p>
</li>
</ol>
<div class="my-8 flex rounded-3xl p-6 bg-sky-50 dark:bg-slate-800/60 dark:ring-1 dark:ring-slate-300/10"><svg viewBox="0 0 32 32" fill="none" class="h-8 w-8 flex-none [--icon-foreground:var(--color-slate-900)] [--icon-background:var(--color-white)]"><defs><radialGradient cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" id="_S_4_-gradient" gradientTransform="matrix(0 21 -21 0 20 11)"><stop stop-color="#0EA5E9"></stop><stop stop-color="#22D3EE" offset=".527"></stop><stop stop-color="#818CF8" offset="1"></stop></radialGradient><radialGradient cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" id="_S_4_-gradient-dark" gradientTransform="matrix(0 24.5001 -19.2498 0 16 5.5)"><stop stop-color="#0EA5E9"></stop><stop stop-color="#22D3EE" offset=".527"></stop><stop stop-color="#818CF8" offset="1"></stop></radialGradient></defs><g class="dark:hidden"><circle cx="20" cy="20" r="12" fill="url(#_S_4_-gradient)"></circle><path fill-rule="evenodd" clip-rule="evenodd" d="M20 24.995c0-1.855 1.094-3.501 2.427-4.792C24.61 18.087 26 15.07 26 12.231 26 7.133 21.523 3 16 3S6 7.133 6 12.23c0 2.84 1.389 5.857 3.573 7.973C10.906 21.494 12 23.14 12 24.995V27a2 2 0 0 0 2 2h4a2 2 0 0 0 2-2v-2.005Z" class="fill-(--icon-background)" fill-opacity="0.5"></path><path d="M25 12.23c0 2.536-1.254 5.303-3.269 7.255l1.391 1.436c2.354-2.28 3.878-5.547 3.878-8.69h-2ZM16 4c5.047 0 9 3.759 9 8.23h2C27 6.508 21.998 2 16 2v2Zm-9 8.23C7 7.76 10.953 4 16 4V2C10.002 2 5 6.507 5 12.23h2Zm3.269 7.255C8.254 17.533 7 14.766 7 12.23H5c0 3.143 1.523 6.41 3.877 8.69l1.392-1.436ZM13 27v-2.005h-2V27h2Zm1 1a1 1 0 0 1-1-1h-2a3 3 0 0 0 3 3v-2Zm4 0h-4v2h4v-2Zm1-1a1 1 0 0 1-1 1v2a3 3 0 0 0 3-3h-2Zm0-2.005V27h2v-2.005h-2ZM8.877 20.921C10.132 22.136 11 23.538 11 24.995h2c0-2.253-1.32-4.143-2.731-5.51L8.877 20.92Zm12.854-1.436C20.32 20.852 19 22.742 19 24.995h2c0-1.457.869-2.859 2.122-4.074l-1.391-1.436Z" class="fill-(--icon-foreground)"></path><path d="M20 26a1 1 0 1 0 0-2v2Zm-8-2a1 1 0 1 0 0 2v-2Zm2 0h-2v2h2v-2Zm1 1V13.5h-2V25h2Zm-5-11.5v1h2v-1h-2Zm3.5 4.5h5v-2h-5v2Zm8.5-3.5v-1h-2v1h2ZM20 24h-2v2h2v-2Zm-2 0h-4v2h4v-2Zm-1-10.5V25h2V13.5h-2Zm2.5-2.5a2.5 2.5 0 0 0-2.5 2.5h2a.5.5 0 0 1 .5-.5v-2Zm2.5 2.5a2.5 2.5 0 0 0-2.5-2.5v2a.5.5 0 0 1 .5.5h2ZM18.5 18a3.5 3.5 0 0 0 3.5-3.5h-2a1.5 1.5 0 0 1-1.5 1.5v2ZM10 14.5a3.5 3.5 0 0 0 3.5 3.5v-2a1.5 1.5 0 0 1-1.5-1.5h-2Zm2.5-3.5a2.5 2.5 0 0 0-2.5 2.5h2a.5.5 0 0 1 .5-.5v-2Zm2.5 2.5a2.5 2.5 0 0 0-2.5-2.5v2a.5.5 0 0 1 .5.5h2Z" class="fill-(--icon-foreground)"></path></g><g class="hidden dark:inline"><path fill-rule="evenodd" clip-rule="evenodd" d="M16 2C10.002 2 5 6.507 5 12.23c0 3.144 1.523 6.411 3.877 8.691.75.727 1.363 1.52 1.734 2.353.185.415.574.726 1.028.726H12a1 1 0 0 0 1-1v-4.5a.5.5 0 0 0-.5-.5A3.5 3.5 0 0 1 9 14.5V14a3 3 0 1 1 6 0v9a1 1 0 1 0 2 0v-9a3 3 0 1 1 6 0v.5a3.5 3.5 0 0 1-3.5 3.5.5.5 0 0 0-.5.5V23a1 1 0 0 0 1 1h.36c.455 0 .844-.311 1.03-.726.37-.833.982-1.626 1.732-2.353 2.354-2.28 3.878-5.547 3.878-8.69C27 6.507 21.998 2 16 2Zm5 25a1 1 0 0 0-1-1h-8a1 1 0 0 0-1 1 3 3 0 0 0 3 3h4a3 3 0 0 0 3-3Zm-8-13v1.5a.5.5 0 0 1-.5.5 1.5 1.5 0 0 1-1.5-1.5V14a1 1 0 1 1 2 0Zm6.5 2a.5.5 0 0 1-.5-.5V14a1 1 0 1 1 2 0v.5a1.5 1.5 0 0 1-1.5 1.5Z" fill="url(#_S_4_-gradient-dark)"></path></g></svg><div class="ml-4 flex-auto"><p class="not-prose font-display text-xl text-sky-900 dark:text-sky-400">Note</p><div class="prose mt-2.5 text-sky-800 [--tw-prose-background:var(--color-sky-50)] prose-a:text-sky-900 prose-code:text-sky-900 dark:text-slate-300 dark:prose-code:text-slate-300">
<!-- -->
<!-- -->
<p>To prevent timing attacks the algorithm at point #3 must run in constant time, therefore
implementors must check <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.04398em">z</span></span></span></span> against <strong>all</strong> 10 proofs even if one succeeds before checking the
last.</p>
<!-- -->
</div></div></div>
<h3 id="test-vectors"><a aria-hidden="true" tabindex="-1" href="#test-vectors"><span class="icon icon-link"></span></a>Test Vectors</h3>
<p>TODO</p>
<h2 id="best-practices"><a aria-hidden="true" tabindex="-1" href="#best-practices"><span class="icon icon-link"></span></a>Best Practices</h2>
<p>Since the account key pairs are derived from both the seed and the password, changing password after
the setup phase is not possible in this version of the Libernet wallet (a different password would
decode different accounts). The passwords are effectively part of the secret that allows recovering
the account keys, and must be treated as such. Implementors should never store these passwords
anywhere and should clearly indicate to the user that they cannot be recovered.</p>
<p>It is possible to add new passwords by running a new <a href="#setup-phase">setup phase</a> with the existing
seed. The new passwords will decode new accounts while the existing passwords will keep decoding the
existing accounts.</p>
<p>Since we hard-coded a limit of 10 passwords per wallet, implementations <strong>must never</strong> allow more,
as doing so would invalidate plausible deniability by revealing that the user is using more than 10
passwords.</p>
<p>Never allow two or more identical passwords in the setup phase, as those would yield identical
proofs in the <code>y</code> array and degrade plausible deniability by leaking information. For example, if
three elements of <code>y</code> are identical it means the user repeated the same password 3 times and is
using no more than 7 other passwords.</p>
<p>Since the user is expected to remember all passwords, backing up the seed alone is sufficient to
back up the entire wallet. When restoring a backup, implementors can run the setup phase asking the
user to provide all passwords. If one or more passwords can&#x27;t be provided right away, a new setup
phase can always be run later.</p>
<p>Even though the seed alone is insufficient to recover any account keys it&#x27;s unadvisable to store it
in cleartext when backing it up. The Argon2 key derivation function we use will resist dictionary
and brute force attacks even if carried out by highly parallel actors equipped with GPU clusters,
but a targeted attack may use a relatively small dictionary and become successful (in layman&#x27;s
terms, someone who knows you well enough might just guess your password right).</p><!--$--><!--/$--></div></article><dl class="mt-12 flex border-t border-slate-200 pt-6 dark:border-slate-800"><div><dt class="font-display text-sm font-medium text-slate-900 dark:text-white">Previous</dt><dd class="mt-1"><a class="flex items-center gap-x-1 text-base font-semibold text-slate-500 hover:text-slate-600 dark:text-slate-400 dark:hover:text-slate-300 flex-row-reverse" href="/dev/protocol">Wire Protocol<svg viewBox="0 0 16 16" aria-hidden="true" class="h-4 w-4 flex-none fill-current -scale-x-100"><path d="m9.182 13.423-1.17-1.16 3.505-3.505H3V7.065h8.517l-3.506-3.5L9.181 2.4l5.512 5.511-5.511 5.512Z"></path></svg></a></dd></div><div class="ml-auto text-right"><dt class="font-display text-sm font-medium text-slate-900 dark:text-white">Next</dt><dd class="mt-1"><a class="flex items-center gap-x-1 text-base font-semibold text-slate-500 hover:text-slate-600 dark:text-slate-400 dark:hover:text-slate-300" href="/dev/plonk">zkSNARKs and PLONK<svg viewBox="0 0 16 16" aria-hidden="true" class="h-4 w-4 flex-none fill-current"><path d="m9.182 13.423-1.17-1.16 3.505-3.505H3V7.065h8.517l-3.506-3.5L9.181 2.4l5.512 5.511-5.511 5.512Z"></path></svg></a></dd></div></dl></div></div></div><script src="/_next/static/chunks/945fab894dcb74b9.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[96923,[\"/_next/static/chunks/5ea14be58487f1ab.js\",\"/_next/static/chunks/68246509281fa544.js\"],\"Providers\"]\n3:I[70119,[\"/_next/static/chunks/5ea14be58487f1ab.js\",\"/_next/static/chunks/68246509281fa544.js\"],\"Header\"]\n4:I[72776,[\"/_next/static/chunks/5ea14be58487f1ab.js\",\"/_next/static/chunks/68246509281fa544.js\"],\"Navigation\"]\n5:I[39756,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"default\"]\n6:I[37457,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"default\"]\n7:I[22016,[\"/_next/static/chunks/5ea14be58487f1ab.js\",\"/_next/static/chunks/68246509281fa544.js\"],\"\"]\n8:I[45494,[\"/_next/static/chunks/5ea14be58487f1ab.js\",\"/_next/static/chunks/68246509281fa544.js\",\"/_next/static/chunks/8a9742a9e956ace0.js\"],\"DocsHeader\"]\nd:I[68027,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"default\"]\n:HL[\"/_next/static/chunks/ea40ae979bfe4280.css\",\"style\"]\n:HL[\"https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex.min.css\",\"style\",{\"crossOrigin\":\"anonymous\",\"integrity\":\"sha384-WcoG4HRXMzYzfCgiyfrySxx90XSl2rxY5mnVY5TwtWE6KLrArNKn0T/mOgNL0Mmi\"}]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"XqGjjMBGxejP92vqRqytZ\",\"c\":[\"\",\"dev\",\"wallet\",\"v1\"],\"q\":\"\",\"i\":false,\"f\":[[[\"\",{\"children\":[\"dev\",{\"children\":[\"wallet\",{\"children\":[\"v1\",{\"children\":[\"__PAGE__\",{}]}]}]}]},\"$undefined\",\"$undefined\",true],[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/chunks/ea40ae979bfe4280.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/5ea14be58487f1ab.js\",\"async\":true,\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-1\",{\"src\":\"/_next/static/chunks/68246509281fa544.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"className\":\"h-full antialiased inter_2fe1ab3d-module__-T-KAq__variable lexend_b0aebfd3-module__hhPs7G__variable\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"head\",null,{\"children\":[\"$\",\"link\",null,{\"rel\":\"stylesheet\",\"href\":\"https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex.min.css\",\"integrity\":\"sha384-WcoG4HRXMzYzfCgiyfrySxx90XSl2rxY5mnVY5TwtWE6KLrArNKn0T/mOgNL0Mmi\",\"crossOrigin\":\"anonymous\"}]}],[\"$\",\"body\",null,{\"className\":\"flex min-h-full bg-white dark:bg-slate-900\",\"children\":[\"$\",\"$L2\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"flex w-full flex-col\",\"children\":[[\"$\",\"$L3\",null,{}],[\"$\",\"div\",null,{\"className\":\"max-w-8xl relative mx-auto flex w-full flex-auto justify-center sm:px-2 lg:px-8 xl:px-12\",\"children\":[[\"$\",\"div\",null,{\"className\":\"hidden lg:relative lg:block lg:flex-none\",\"children\":[[\"$\",\"div\",null,{\"className\":\"absolute inset-y-0 right-0 w-[50vw] bg-slate-50 dark:hidden\"}],[\"$\",\"div\",null,{\"className\":\"absolute top-16 right-0 bottom-0 hidden h-12 w-px bg-linear-to-t from-slate-800 dark:block\"}],[\"$\",\"div\",null,{\"className\":\"absolute top-28 right-0 bottom-0 hidden w-px bg-slate-800 dark:block\"}],[\"$\",\"div\",null,{\"className\":\"sticky top-19 -ml-0.5 h-[calc(100vh-4.75rem)] w-64 overflow-x-hidden overflow-y-auto py-16 pr-8 pl-0.5 xl:w-72 xl:pr-16\",\"children\":[\"$\",\"$L4\",null,{}]}]]}],[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L6\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"div\",null,{\"className\":\"max-w-2xl min-w-0 flex-auto px-4 py-16 lg:max-w-none lg:pr-0 lg:pl-8 xl:px-16\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex h-full flex-col items-center justify-center text-center\",\"children\":[[\"$\",\"p\",null,{\"className\":\"font-display text-sm font-medium text-slate-900 dark:text-white\",\"children\":\"404\"}],[\"$\",\"h1\",null,{\"className\":\"font-display mt-3 text-3xl tracking-tight text-slate-900 dark:text-white\",\"children\":\"Page not found\"}],[\"$\",\"p\",null,{\"className\":\"mt-2 text-sm text-slate-500 dark:text-slate-400\",\"children\":\"Sorry, we couldn't find the page you're looking for.\"}],[\"$\",\"$L7\",null,{\"href\":\"/\",\"className\":\"mt-8 text-sm font-medium text-slate-900 dark:text-white\",\"children\":\"Go back home\"}]]}]}],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}]]}]}]}]]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L6\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L6\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/8a9742a9e956ace0.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"div\",null,{\"className\":\"max-w-2xl min-w-0 flex-auto px-4 py-16 lg:max-w-none lg:pr-0 lg:pl-8 xl:px-16\",\"children\":[[\"$\",\"article\",null,{\"children\":[[\"$\",\"$L8\",null,{\"title\":\"Wallet Format V1\"}],[\"$\",\"div\",null,{\"className\":\"prose prose-slate dark:prose-invert max-w-none dark:text-slate-400 prose-headings:scroll-mt-28 prose-headings:font-display prose-headings:font-normal lg:prose-headings:scroll-mt-34 prose-lead:text-slate-500 dark:prose-lead:text-slate-400 prose-a:font-semibold dark:prose-a:text-sky-400 prose-a:no-underline prose-a:shadow-[inset_0_-2px_0_0_var(--tw-prose-background,#fff),inset_0_calc(-1*(var(--tw-prose-underline-size,4px)+2px))_0_0_var(--tw-prose-underline,var(--color-sky-300))] prose-a:hover:[--tw-prose-underline-size:6px] dark:prose-a:shadow-[inset_0_calc(-1*var(--tw-prose-underline-size,2px))_0_0_var(--tw-prose-underline,var(--color-sky-800))] dark:prose-a:hover:[--tw-prose-underline-size:6px] dark:[--tw-prose-background:var(--color-slate-900)] prose-pre:rounded-xl prose-pre:bg-slate-900 prose-pre:shadow-lg dark:prose-pre:bg-slate-800/60 dark:prose-pre:shadow-none dark:prose-pre:ring-1 dark:prose-pre:ring-slate-300/10 dark:prose-hr:border-slate-800\",\"children\":\"$L9\"}]]}],\"$La\"]}]]}],{\"children\":[\"$Lb\",{},null,false,false]},null,false,false]},null,false,false]},null,false,false]},null,false,false],\"$Lc\",false]],\"m\":\"$undefined\",\"G\":[\"$d\",[]],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"e:I[62253,[\"/_next/static/chunks/5ea14be58487f1ab.js\",\"/_next/static/chunks/68246509281fa544.js\",\"/_next/static/chunks/8a9742a9e956ace0.js\"],\"PrevNextLinks\"]\n34:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"ViewportBoundary\"]\n36:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"MetadataBoundary\"]\n37:\"$Sreact.suspense\"\n9:[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L6\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]\na:[\"$\",\"$Le\",null,{}]\n"])</script><script>self.__next_f.push([1,"b:[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"h2\",null,{\"id\":\"overview\",\"children\":[[\"$\",\"a\",null,{\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"href\":\"#overview\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"Overview\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"This page specifies the file format used to store Libernet wallets and the process to derive the\\nactual accounts of a wallet.\"}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"anatomy-of-an-account\",\"children\":[[\"$\",\"a\",null,{\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"href\":\"#anatomy-of-an-account\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"Anatomy of an Account\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"An account is a \",[\"$\",\"a\",null,{\"href\":\"https://hackmd.io/@benjaminion/bls12-381\",\"children\":\"BLS12-381\"}],\" key pair that can be used to sign Libernet transactions. On\\nthe public ledger, accounts are known by their \",[\"$\",\"em\",null,{\"children\":\"address\"}],\", which is computed using the SHA3 hash of\\nthe public BLS key (see the following sections for the exact procedure).\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Example account:\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"private BLS key scalar (32 bytes): \",[\"$\",\"code\",null,{\"children\":\"0x2dde5ffbbc881910a9b1cc9567eae3c1e3f8563f4e2771eb9957ead7b7d6a3c5\"}]]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"public BLS key point in compressed form (48 bytes): \",[\"$\",\"code\",null,{\"children\":\"0xaa4130eebea382e2c4312186290585d620b858c41a4316d8b62beacb0a443690d7d751ddd7b12eaa58470d29a0bf468b\"}]]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"account address (a BLS scalar computed from the SHA3 hash of the public key): \",[\"$\",\"code\",null,{\"children\":\"0x210b0a3a23416f66a210531ec98db0fc39162b288f48de9289a6186af4f3eba1\"}]]}],\"\\n\"]}],\"\\n\",[\"$\",\"div\",null,{\"className\":\"my-8 flex rounded-3xl p-6 bg-amber-50 dark:bg-slate-800/60 dark:ring-1 dark:ring-slate-300/10\",\"children\":[[\"$\",\"svg\",null,{\"viewBox\":\"0 0 32 32\",\"fill\":\"none\",\"className\":\"h-8 w-8 flex-none [--icon-foreground:var(--color-amber-900)] [--icon-background:var(--color-amber-100)]\",\"children\":[[\"$\",\"defs\",null,{\"children\":[[\"$\",\"radialGradient\",null,{\"cx\":0,\"cy\":0,\"r\":1,\"gradientUnits\":\"userSpaceOnUse\",\"id\":\"_S_1_-gradient\",\"gradientTransform\":\"rotate(65.924 1.519 20.92) scale(25.7391)\",\"children\":[[\"$\",\"stop\",\"0\",{\"stopColor\":\"#FDE68A\",\"offset\":\".08\"}],[\"$\",\"stop\",\"1\",{\"stopColor\":\"#F59E0B\",\"offset\":\".837\"}]]}],[\"$\",\"radialGradient\",null,{\"cx\":0,\"cy\":0,\"r\":1,\"gradientUnits\":\"userSpaceOnUse\",\"id\":\"_S_1_-gradient-dark\",\"gradientTransform\":\"matrix(0 24.5 -24.5 0 16 5.5)\",\"children\":[[\"$\",\"stop\",\"0\",{\"stopColor\":\"#FDE68A\",\"offset\":\".08\"}],[\"$\",\"stop\",\"1\",{\"stopColor\":\"#F59E0B\",\"offset\":\".837\"}]]}]]}],[\"$\",\"g\",null,{\"className\":\"dark:hidden\",\"children\":[[\"$\",\"circle\",null,{\"cx\":20,\"cy\":20,\"r\":12,\"fill\":\"url(#_S_1_-gradient)\"}],[\"$\",\"path\",null,{\"d\":\"M3 16c0 7.18 5.82 13 13 13s13-5.82 13-13S23.18 3 16 3 3 8.82 3 16Z\",\"fillOpacity\":0.5,\"className\":\"fill-(--icon-background) stroke-(--icon-foreground)\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\"}],[\"$\",\"path\",null,{\"d\":\"m15.408 16.509-1.04-5.543a1.66 1.66 0 1 1 3.263 0l-1.039 5.543a.602.602 0 0 1-1.184 0Z\",\"className\":\"fill-(--icon-foreground) stroke-(--icon-foreground)\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\"}],[\"$\",\"path\",null,{\"d\":\"M16 23a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z\",\"fillOpacity\":0.5,\"stroke\":\"currentColor\",\"className\":\"fill-(--icon-background) stroke-(--icon-foreground)\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\"}]]}],[\"$\",\"g\",null,{\"className\":\"hidden dark:inline\",\"children\":[\"$\",\"path\",null,{\"fillRule\":\"evenodd\",\"clipRule\":\"evenodd\",\"d\":\"M2 16C2 8.268 8.268 2 16 2s14 6.268 14 14-6.268 14-14 14S2 23.732 2 16Zm11.386-4.85a2.66 2.66 0 1 1 5.228 0l-1.039 5.543a1.602 1.602 0 0 1-3.15 0l-1.04-5.543ZM16 20a2 2 0 1 0 0 4 2 2 0 0 0 0-4Z\",\"fill\":\"url(#_S_1_-gradient-dark)\"}]}]]}],[\"$\",\"div\",null,{\"className\":\"ml-4 flex-auto\",\"children\":[[\"$\",\"p\",null,{\"className\":\"not-prose font-display text-xl text-amber-900 dark:text-amber-500\",\"children\":\"Warning\"}],[\"$\",\"div\",null,{\"className\":\"prose mt-2.5 text-amber-800 [--tw-prose-underline:var(--color-amber-400)] [--tw-prose-background:var(--color-amber-50)] prose-a:text-amber-900 prose-code:text-amber-900 dark:text-slate-300 dark:[--tw-prose-underline:var(--color-sky-700)] dark:prose-code:text-slate-300\",\"children\":[\"\\n\",\"$Lf\",\"\\n\",\"$L10\",\"\\n\"]}]]}]]}],\"\\n\",\"$L11\",\"\\n\",\"$L12\",\"\\n\",\"$L13\",\"\\n\",\"$L14\",\"\\n\",\"$L15\",\"\\n\",\"$L16\",\"\\n\",\"$L17\",\"\\n\",\"$L18\",\"\\n\",\"$L19\",\"\\n\",\"$L1a\",\"\\n\",\"$L1b\",\"\\n\",\"$L1c\",\"\\n\",\"$L1d\",\"\\n\",\"$L1e\",\"\\n\",\"$L1f\",\"\\n\",\"$L20\",\"\\n\",\"$L21\",\"\\n\",\"$L22\",\"\\n\",\"$L23\",\"\\n\",\"$L24\",\"\\n\",\"$L25\",\"\\n\",\"$L26\",\"\\n\",\"$L27\",\"\\n\",\"$L28\",\"\\n\",\"$L29\",\"\\n\",\"$L2a\",\"\\n\",\"$L2b\",\"\\n\",\"$L2c\",\"\\n\",\"$L2d\",\"\\n\",\"$L2e\",\"\\n\",\"$L2f\",\"\\n\",\"$L30\",\"\\n\",\"$L31\",\"\\n\",\"$L32\"],null,\"$L33\"]}]\n"])</script><script>self.__next_f.push([1,"c:[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$L34\",null,{\"children\":\"$@35\"}],[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$L36\",null,{\"children\":[\"$\",\"$37\",null,{\"name\":\"Next.Metadata\",\"children\":\"$@38\"}]}]}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}]\n"])</script><script>self.__next_f.push([1,"45:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"OutletBoundary\"]\nf:null\n10:[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Do not use the account above, it's leaked. Any assets transferred to this account will be\\n\",[\"$\",\"strong\",null,{\"children\":\"permanently lost\"}],\".\"]}],\"\\n\"]\n11:[\"$\",\"p\",null,{\"children\":\"The public ledger associates LIB balances and other assets to account addresses, and the protocol\\ngrants ownership of such assets to the key pair whose public key hashes to the corresponding\\naddress.\"}]\n12:[\"$\",\"h2\",null,{\"id\":\"wallet-features\",\"children\":[[\"$\",\"a\",null,{\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"href\":\"#wallet-features\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"Wallet Features\"]}]\n13:[\"$\",\"p\",null,{\"children\":\"A single wallet file can derive an unlimited number of accounts. These accounts are completely\\nindependent of each other, meaning it's infeasible for any external actors to determine whether any\\ntwo given accounts were generated from the same wallet.\"}]\n14:[\"$\",\"p\",null,{\"children\":\"Wallets have a seed and one or more associated passwords (up to 10). The algorithm to derive an\\nactual account key pair uses the seed and one of the passwords. As a result, different passwords\\nwill generate completely different accounts, and this is the basis for Libernet's plausible\\ndeniability scheme.\"}]\n15:[\"$\",\"p\",null,{\"children\":[\"The seed of a wallet is stored in cleartext in the wallet file, while the passwords are never stored\\ndirectly. Instead, we use the \",[\"$\",\"a\",null,{\"href\":\"https://dankradfeist.de/ethereum/2020/06/16/kate-polynomial-commitments.html\",\"children\":\"KZG polynomial commitment scheme\"}],\" to commit to them and check\\npassword correctness when a user wants to unlock a wallet.\"]}]\n16:[\"$\",\"h2\",null,{\"id\":\"wallet-format\",\"children\":[[\"$\",\"a\",null,{\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"href\":\"#wallet-format\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"Wallet Format\"]}]\n17:[\"$\",\"p\",null,{\"children\":[\"A version 1 Libernet wallet file is a \",[\"$\",\"a\",null,{\"href\":\"https://www.json.org/\",\"children\":\"JSON\"}],\" file with the following fields:\"]}]\n18:[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"version\"}],\" must be the string \",[\"$\",\"code\",null,{\"children\":\"1.0\"}],\".\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"seed\"}],\" is a 64-byte random number stored as a string in lower-case hex format prefixed with \",[\"$\",\"code\",null,{\"children\":\"0x\"}],\",\\ne.g. \",[\"$\",\"code\",null,{\"children\":\"0x4bbda518f23220af8eb7e8324cf132c0733b9c876c8e3112c69a27b779d22bf8bb7d089e1ef1706772abd511fc5b45f654e9fcb31fe30875bd6ff0648585cf92\"}],\".\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"c\"}],\" is a BLS point over G1 in compressed format (48 bytes), stored as a string in lower-case hex\\nformat prefixed with \",[\"$\",\"code\",null,{\"children\":\"0x\"}],\".\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"y\"}],\" is an array containing exactly 10 BLS points over G1, each having the same format as \",[\"$\",\"code\",null,{\"children\":\"c\"}],\".\"]}],\"\\n\"]}]\n19:[\"$\",\"p\",null,{\"children\":\"Example wallet:\"}]\n"])</script><script>self.__next_f.push([1,"1a:[\"$\",\"div\",null,{\"className\":\"my-8 flex rounded-3xl p-6 bg-amber-50 dark:bg-slate-800/60 dark:ring-1 dark:ring-slate-300/10\",\"children\":[[\"$\",\"svg\",null,{\"viewBox\":\"0 0 32 32\",\"fill\":\"none\",\"className\":\"h-8 w-8 flex-none [--icon-foreground:var(--color-amber-900)] [--icon-background:var(--color-amber-100)]\",\"children\":[[\"$\",\"defs\",null,{\"children\":[[\"$\",\"radialGradient\",null,{\"cx\":0,\"cy\":0,\"r\":1,\"gradientUnits\":\"userSpaceOnUse\",\"id\":\"_S_2_-gradient\",\"gradientTransform\":\"rotate(65.924 1.519 20.92) scale(25.7391)\",\"children\":[[\"$\",\"stop\",\"0\",{\"stopColor\":\"#FDE68A\",\"offset\":\".08\"}],[\"$\",\"stop\",\"1\",{\"stopColor\":\"#F59E0B\",\"offset\":\".837\"}]]}],[\"$\",\"radialGradient\",null,{\"cx\":0,\"cy\":0,\"r\":1,\"gradientUnits\":\"userSpaceOnUse\",\"id\":\"_S_2_-gradient-dark\",\"gradientTransform\":\"matrix(0 24.5 -24.5 0 16 5.5)\",\"children\":[[\"$\",\"stop\",\"0\",{\"stopColor\":\"#FDE68A\",\"offset\":\".08\"}],[\"$\",\"stop\",\"1\",{\"stopColor\":\"#F59E0B\",\"offset\":\".837\"}]]}]]}],[\"$\",\"g\",null,{\"className\":\"dark:hidden\",\"children\":[[\"$\",\"circle\",null,{\"cx\":20,\"cy\":20,\"r\":12,\"fill\":\"url(#_S_2_-gradient)\"}],[\"$\",\"path\",null,{\"d\":\"M3 16c0 7.18 5.82 13 13 13s13-5.82 13-13S23.18 3 16 3 3 8.82 3 16Z\",\"fillOpacity\":0.5,\"className\":\"fill-(--icon-background) stroke-(--icon-foreground)\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\"}],[\"$\",\"path\",null,{\"d\":\"m15.408 16.509-1.04-5.543a1.66 1.66 0 1 1 3.263 0l-1.039 5.543a.602.602 0 0 1-1.184 0Z\",\"className\":\"fill-(--icon-foreground) stroke-(--icon-foreground)\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\"}],[\"$\",\"path\",null,{\"d\":\"M16 23a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z\",\"fillOpacity\":0.5,\"stroke\":\"currentColor\",\"className\":\"fill-(--icon-background) stroke-(--icon-foreground)\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\"}]]}],[\"$\",\"g\",null,{\"className\":\"hidden dark:inline\",\"children\":[\"$\",\"path\",null,{\"fillRule\":\"evenodd\",\"clipRule\":\"evenodd\",\"d\":\"M2 16C2 8.268 8.268 2 16 2s14 6.268 14 14-6.268 14-14 14S2 23.732 2 16Zm11.386-4.85a2.66 2.66 0 1 1 5.228 0l-1.039 5.543a1.602 1.602 0 0 1-3.15 0l-1.04-5.543ZM16 20a2 2 0 1 0 0 4 2 2 0 0 0 0-4Z\",\"fill\":\"url(#_S_2_-gradient-dark)\"}]}]]}],[\"$\",\"div\",null,{\"className\":\"ml-4 flex-auto\",\"children\":[[\"$\",\"p\",null,{\"className\":\"not-prose font-display text-xl text-amber-900 dark:text-amber-500\",\"children\":\"Warning\"}],[\"$\",\"div\",null,{\"className\":\"prose mt-2.5 text-amber-800 [--tw-prose-underline:var(--color-amber-400)] [--tw-prose-background:var(--color-amber-50)] prose-a:text-amber-900 prose-code:text-amber-900 dark:text-slate-300 dark:[--tw-prose-underline:var(--color-sky-700)] dark:prose-code:text-slate-300\",\"children\":[\"\\n\",null,\"\\n\",[\"\\n\",[\"$\",\"p\",null,{\"children\":\"Do not use the following wallet, it's leaked.\"}],\"\\n\"],\"\\n\"]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"1b:[\"$\",\"div\",null,{\"className\":\"remark-highlight\",\"children\":[\"$\",\"pre\",null,{\"className\":\"language-json\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-json\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n  \",[\"$\",\"span\",null,{\"className\":\"token property\",\"children\":\"\\\"version\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"1.0\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n  \",[\"$\",\"span\",null,{\"className\":\"token property\",\"children\":\"\\\"seed\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"0x4bbda518f23220af8eb7e8324cf132c0733b9c876c8e3112c69a27b779d22bf8bb7d089e1ef1706772abd511fc5b45f654e9fcb31fe30875bd6ff0648585cf92\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n  \",[\"$\",\"span\",null,{\"className\":\"token property\",\"children\":\"\\\"c\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"0x801779b8613e11f65317ccdb11c950461b9c305276e06d65316d66322b23d85088a0e9b68381a4531d970062345825e7\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n  \",[\"$\",\"span\",null,{\"className\":\"token property\",\"children\":\"\\\"y\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"\\n    \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"0xb466b114add86cef49255e1479436eb4fe49798dbb7573bbf073cb8b9ceee5bf09d3e2465fec4fb9d7819bff62288373\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n    \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"0x8de02594854b5ce06126cdfb0984be3d0b9bc162236c1221f951c358f160d1063397a2e9496366eb4d5c876946234a40\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n    \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"0x900b96dbccd6309840fa075ce54d61a25c212076c329cbdc425e3dbe74380ced054960d144560903112b3ed53ff96d03\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n    \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"0xa4fbeb582ce042e4e9f37db0eca05a1b47293873dc12fd2901dd4822f9017ecf57bf6169af8121daf67755661c18393e\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n    \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"0x83332293c2508f407a4c56792e4e6f06f209bb7751ce0f738c379548fbf9e1f76adfd6f11fc40885a0538f6893683a36\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n    \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"0x881cded5f5efcf4c1618b727bdcc6ecf509a658b7e422b556feab0df4948012a7e65cd89f25bf62f81529136baee0630\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n    \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"0x858c616dad16af911b8afad048de067c5f8e092f82d895f2b0a0f8f0a211a84ff39ce5545d2b7e01becea48fc96b425e\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n    \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"0xb30942bb2f1a7bfc90bbbd9a0b23fe1b08478ad38fab2ed7bcd75c6785f3d2f6d6e6e5e59cececacece4376922ad30a8\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n    \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"0x87abdc824b25ec12162b3062217e5216c624d15a050ccd4d6cc2ad3f9b13f7c9dbda05f9114e49b922bad788e2e5c825\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n    \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"0x85d650e5a5c1ea3ebf4d575f143251158600c4c3bfd2e0fbbc883dd7d1d40f5ca9ddbb91efc3eed5825e62814150a1a8\\\"\"}],\"\\n  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],\"\\n\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]}]}]\n"])</script><script>self.__next_f.push([1,"1c:[\"$\",\"h2\",null,{\"id\":\"derivation-algorithm\",\"children\":[[\"$\",\"a\",null,{\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"href\":\"#derivation-algorithm\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"Derivation Algorithm\"]}]\n1d:[\"$\",\"h3\",null,{\"id\":\"general-notes\",\"children\":[[\"$\",\"a\",null,{\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"href\":\"#general-notes\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"General Notes\"]}]\n1e:[\"$\",\"p\",null,{\"children\":\"In the following algorithm we perform modular reduction from 512-bit integers to BLS scalars every\\ntime we need to switch to algebraic cryptography, e.g. when converting a SHA3 hash to a scalar. The\\nreason why we use 512-bit cryptography despite 256 bits being generally considered safe is to\\nwarrant a uniform distribution of the resulting scalar.\"}]\n1f:[\"$\",\"p\",null,{\"children\":\"The order of the BLS12-381 scalar field is the following ~255-bit prime number:\"}]\n20:[\"$\",\"div\",null,{\"className\":\"remark-highlight\",\"children\":[\"$\",\"pre\",null,{\"className\":\"language-unknown\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-unknown\",\"children\":\"r = 0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001\"}]}]}]\n21:[\"$\",\"p\",null,{\"children\":[\"Note that the first few nibbles are \",[\"$\",\"code\",null,{\"children\":\"73ed...\"}],\", so this value is roughly 0.45 times the full 256-bit\\nrange. Performing modular reduction from the 256-bit range to the \",[\"$\",\"span\",null,{\"className\":\"katex\",\"children\":[[\"$\",\"span\",null,{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",null,{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",null,{\"children\":[[\"$\",\"mrow\",null,{\"children\":[\"$\",\"mi\",null,{\"children\":\"r\"}]}],[\"$\",\"annotation\",null,{\"encoding\":\"application/x-tex\",\"children\":\"r\"}]]}]}]}],[\"$\",\"span\",null,{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"0.4306em\"}}],[\"$\",\"span\",null,{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.02778em\"},\"children\":\"r\"}]]}]}]]}],\" range would result in a\\nvisible skew of the distribution, as ~10% of the values would become 50% more frequent.\"]}]\n"])</script><script>self.__next_f.push([1,"22:[\"$\",\"p\",null,{\"children\":[\"On the other hand, the 512-bit range is astronomically larger than \",[\"$\",\"span\",null,{\"className\":\"katex\",\"children\":[[\"$\",\"span\",null,{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",null,{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",null,{\"children\":[[\"$\",\"mrow\",null,{\"children\":[\"$\",\"mi\",null,{\"children\":\"r\"}]}],[\"$\",\"annotation\",null,{\"encoding\":\"application/x-tex\",\"children\":\"r\"}]]}]}]}],[\"$\",\"span\",null,{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"0.4306em\"}}],[\"$\",\"span\",null,{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.02778em\"},\"children\":\"r\"}]]}]}]]}],\" (more than \",[\"$\",\"span\",null,{\"className\":\"katex\",\"children\":[[\"$\",\"span\",null,{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",null,{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",null,{\"children\":[[\"$\",\"mrow\",null,{\"children\":[\"$\",\"msup\",null,{\"children\":[[\"$\",\"mn\",null,{\"children\":\"2\"}],[\"$\",\"mn\",null,{\"children\":\"256\"}]]}]}],[\"$\",\"annotation\",null,{\"encoding\":\"application/x-tex\",\"children\":\"2^{256}\"}]]}]}]}],[\"$\",\"span\",null,{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"0.8141em\"}}],[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":[[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":\"2\"}],[\"$\",\"span\",null,{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",null,{\"className\":\"vlist-t\",\"children\":[\"$\",\"span\",null,{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",null,{\"className\":\"vlist\",\"style\":{\"height\":\"0.8141em\"},\"children\":[\"$\",\"span\",null,{\"style\":{\"top\":\"-3.063em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",null,{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord mtight\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord mtight\",\"children\":\"256\"}]}]}]]}]}]}]}]}]]}]]}]}]]}],\" times\\nlarger), so in this case the distribution bias resulting from modular reduction is virtually\\nnon-existent.\"]}]\n"])</script><script>self.__next_f.push([1,"23:[\"$\",\"p\",null,{\"children\":[\"None of the 512-bit values we use in this type of conversion have endianness, so we always assume\\n\",[\"$\",\"strong\",null,{\"children\":\"little endian order\"}],\".\"]}]\n24:[\"$\",\"h3\",null,{\"id\":\"setup-phase\",\"children\":[[\"$\",\"a\",null,{\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"href\":\"#setup-phase\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"Setup Phase\"]}]\n"])</script><script>self.__next_f.push([1,"25:[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Generate the 64-byte seed using a CSPRNG. Let \",[\"$\",\"code\",null,{\"children\":\"s\"}],\" be this seed.\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":\"Let the user enter at least one and at most 10 different passwords. Error out if two or more\\npasswords are identical.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Derive a 64-byte key for each password using the \",[\"$\",\"a\",null,{\"href\":\"https://en.wikipedia.org/wiki/Argon2\",\"children\":\"Argon2id\"}],\" key derivation function with\\nthe following parameters:\"]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"algorithm version: 19 (0x13)\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"M cost: 256 * 1024 (= 256 MiB)\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"T cost: 2\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"P cost: 1\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"salt: the seed \",[\"$\",\"code\",null,{\"children\":\"s\"}]]}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"output length: 64 bytes\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"The passwords must be encoded in UTF-8.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":\"If the user provided less than 10 passwords, add more randomly generated 64-byte keys until there\\nare 10 keys in total. All random keys must be generated by a CSPRNG.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Convert the 10 keys to corresponding BLS scalars via modular reduction. Let \",[\"$\",\"span\",null,{\"className\":\"katex\",\"children\":[[\"$\",\"span\",null,{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",null,{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",null,{\"children\":[[\"$\",\"mrow\",null,{\"children\":[\"$\",\"msub\",null,{\"children\":[[\"$\",\"mi\",null,{\"children\":\"z\"}],[\"$\",\"mi\",null,{\"children\":\"i\"}]]}]}],[\"$\",\"annotation\",null,{\"encoding\":\"application/x-tex\",\"children\":\"z_i\"}]]}]}]}],[\"$\",\"span\",null,{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"0.5806em\",\"verticalAlign\":\"-0.15em\"}}],[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":[[\"$\",\"span\",null,{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.04398em\"},\"children\":\"z\"}],[\"$\",\"span\",null,{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",null,{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",null,{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",null,{\"className\":\"vlist\",\"style\":{\"height\":\"0.3117em\"},\"children\":[\"$\",\"span\",null,{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"-0.044em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",null,{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord mathnormal mtight\",\"children\":\"i\"}]}]]}]}],[\"$\",\"span\",null,{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",null,{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",null,{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",null,{}]}]}]]}]}]]}]]}]}]]}],\" be the \",[\"$\",\"em\",null,{\"children\":\"i\"}],\"-th\\nscalar.\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Compute a polynomial whose roots are the 10 scalars \",[\"$\",\"span\",null,{\"className\":\"katex\",\"children\":[[\"$\",\"span\",null,{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",null,{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",null,{\"children\":[[\"$\",\"mrow\",null,{\"children\":[\"$\",\"msub\",null,{\"children\":[[\"$\",\"mi\",null,{\"children\":\"z\"}],[\"$\",\"mn\",null,{\"children\":\"0\"}]]}]}],[\"$\",\"annotation\",null,{\"encoding\":\"application/x-tex\",\"children\":\"z_0\"}]]}]}]}],[\"$\",\"span\",null,{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"0.5806em\",\"verticalAlign\":\"-0.15em\"}}],[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":[[\"$\",\"span\",null,{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.04398em\"},\"children\":\"z\"}],[\"$\",\"span\",null,{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",null,{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",null,{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",null,{\"className\":\"vlist\",\"style\":{\"height\":\"0.3011em\"},\"children\":[\"$\",\"span\",null,{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"-0.044em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",null,{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord mtight\",\"children\":\"0\"}]}]]}]}],[\"$\",\"span\",null,{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",null,{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",null,{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",null,{}]}]}]]}]}]]}]]}]}]]}],\", \",\"$L39\",\", etc. Let \",\"$L3a\",\" be this\\npolynomial. \",\"$L3b\",\" can be computed as:\"]}],\"\\n\",\"$L3c\",\"\\n\",\"$L3d\",\"\\n\"]}],\"\\n\",\"$L3e\",\"\\n\",\"$L3f\",\"\\n\",\"$L40\",\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"26:[\"$\",\"div\",null,{\"className\":\"my-8 flex rounded-3xl p-6 bg-sky-50 dark:bg-slate-800/60 dark:ring-1 dark:ring-slate-300/10\",\"children\":[[\"$\",\"svg\",null,{\"viewBox\":\"0 0 32 32\",\"fill\":\"none\",\"className\":\"h-8 w-8 flex-none [--icon-foreground:var(--color-slate-900)] [--icon-background:var(--color-white)]\",\"children\":[[\"$\",\"defs\",null,{\"children\":[[\"$\",\"radialGradient\",null,{\"cx\":0,\"cy\":0,\"r\":1,\"gradientUnits\":\"userSpaceOnUse\",\"id\":\"_S_3_-gradient\",\"gradientTransform\":\"matrix(0 21 -21 0 20 11)\",\"children\":[[\"$\",\"stop\",\"0\",{\"stopColor\":\"#0EA5E9\"}],[\"$\",\"stop\",\"1\",{\"stopColor\":\"#22D3EE\",\"offset\":\".527\"}],[\"$\",\"stop\",\"2\",{\"stopColor\":\"#818CF8\",\"offset\":1}]]}],[\"$\",\"radialGradient\",null,{\"cx\":0,\"cy\":0,\"r\":1,\"gradientUnits\":\"userSpaceOnUse\",\"id\":\"_S_3_-gradient-dark\",\"gradientTransform\":\"matrix(0 24.5001 -19.2498 0 16 5.5)\",\"children\":[[\"$\",\"stop\",\"0\",{\"stopColor\":\"#0EA5E9\"}],[\"$\",\"stop\",\"1\",{\"stopColor\":\"#22D3EE\",\"offset\":\".527\"}],[\"$\",\"stop\",\"2\",{\"stopColor\":\"#818CF8\",\"offset\":1}]]}]]}],[\"$\",\"g\",null,{\"className\":\"dark:hidden\",\"children\":[[\"$\",\"circle\",null,{\"cx\":20,\"cy\":20,\"r\":12,\"fill\":\"url(#_S_3_-gradient)\"}],[\"$\",\"path\",null,{\"fillRule\":\"evenodd\",\"clipRule\":\"evenodd\",\"d\":\"M20 24.995c0-1.855 1.094-3.501 2.427-4.792C24.61 18.087 26 15.07 26 12.231 26 7.133 21.523 3 16 3S6 7.133 6 12.23c0 2.84 1.389 5.857 3.573 7.973C10.906 21.494 12 23.14 12 24.995V27a2 2 0 0 0 2 2h4a2 2 0 0 0 2-2v-2.005Z\",\"className\":\"fill-(--icon-background)\",\"fillOpacity\":0.5}],[\"$\",\"path\",null,{\"d\":\"M25 12.23c0 2.536-1.254 5.303-3.269 7.255l1.391 1.436c2.354-2.28 3.878-5.547 3.878-8.69h-2ZM16 4c5.047 0 9 3.759 9 8.23h2C27 6.508 21.998 2 16 2v2Zm-9 8.23C7 7.76 10.953 4 16 4V2C10.002 2 5 6.507 5 12.23h2Zm3.269 7.255C8.254 17.533 7 14.766 7 12.23H5c0 3.143 1.523 6.41 3.877 8.69l1.392-1.436ZM13 27v-2.005h-2V27h2Zm1 1a1 1 0 0 1-1-1h-2a3 3 0 0 0 3 3v-2Zm4 0h-4v2h4v-2Zm1-1a1 1 0 0 1-1 1v2a3 3 0 0 0 3-3h-2Zm0-2.005V27h2v-2.005h-2ZM8.877 20.921C10.132 22.136 11 23.538 11 24.995h2c0-2.253-1.32-4.143-2.731-5.51L8.877 20.92Zm12.854-1.436C20.32 20.852 19 22.742 19 24.995h2c0-1.457.869-2.859 2.122-4.074l-1.391-1.436Z\",\"className\":\"fill-(--icon-foreground)\"}],[\"$\",\"path\",null,{\"d\":\"M20 26a1 1 0 1 0 0-2v2Zm-8-2a1 1 0 1 0 0 2v-2Zm2 0h-2v2h2v-2Zm1 1V13.5h-2V25h2Zm-5-11.5v1h2v-1h-2Zm3.5 4.5h5v-2h-5v2Zm8.5-3.5v-1h-2v1h2ZM20 24h-2v2h2v-2Zm-2 0h-4v2h4v-2Zm-1-10.5V25h2V13.5h-2Zm2.5-2.5a2.5 2.5 0 0 0-2.5 2.5h2a.5.5 0 0 1 .5-.5v-2Zm2.5 2.5a2.5 2.5 0 0 0-2.5-2.5v2a.5.5 0 0 1 .5.5h2ZM18.5 18a3.5 3.5 0 0 0 3.5-3.5h-2a1.5 1.5 0 0 1-1.5 1.5v2ZM10 14.5a3.5 3.5 0 0 0 3.5 3.5v-2a1.5 1.5 0 0 1-1.5-1.5h-2Zm2.5-3.5a2.5 2.5 0 0 0-2.5 2.5h2a.5.5 0 0 1 .5-.5v-2Zm2.5 2.5a2.5 2.5 0 0 0-2.5-2.5v2a.5.5 0 0 1 .5.5h2Z\",\"className\":\"fill-(--icon-foreground)\"}]]}],[\"$\",\"g\",null,{\"className\":\"hidden dark:inline\",\"children\":[\"$\",\"path\",null,{\"fillRule\":\"evenodd\",\"clipRule\":\"evenodd\",\"d\":\"M16 2C10.002 2 5 6.507 5 12.23c0 3.144 1.523 6.411 3.877 8.691.75.727 1.363 1.52 1.734 2.353.185.415.574.726 1.028.726H12a1 1 0 0 0 1-1v-4.5a.5.5 0 0 0-.5-.5A3.5 3.5 0 0 1 9 14.5V14a3 3 0 1 1 6 0v9a1 1 0 1 0 2 0v-9a3 3 0 1 1 6 0v.5a3.5 3.5 0 0 1-3.5 3.5.5.5 0 0 0-.5.5V23a1 1 0 0 0 1 1h.36c.455 0 .844-.311 1.03-.726.37-.833.982-1.626 1.732-2.353 2.354-2.28 3.878-5.547 3.878-8.69C27 6.507 21.998 2 16 2Zm5 25a1 1 0 0 0-1-1h-8a1 1 0 0 0-1 1 3 3 0 0 0 3 3h4a3 3 0 0 0 3-3Zm-8-13v1.5a.5.5 0 0 1-.5.5 1.5 1.5 0 0 1-1.5-1.5V14a1 1 0 1 1 2 0Zm6.5 2a.5.5 0 0 1-.5-.5V14a1 1 0 1 1 2 0v.5a1.5 1.5 0 0 1-1.5 1.5Z\",\"fill\":\"url(#_S_3_-gradient-dark)\"}]}]]}],[\"$\",\"div\",null,{\"className\":\"ml-4 flex-auto\",\"children\":[[\"$\",\"p\",null,{\"className\":\"not-prose font-display text-xl text-sky-900 dark:text-sky-400\",\"children\":\"Note\"}],[\"$\",\"div\",null,{\"className\":\"prose mt-2.5 text-sky-800 [--tw-prose-background:var(--color-sky-50)] prose-a:text-sky-900 prose-code:text-sky-900 dark:text-slate-300 dark:prose-code:text-slate-300\",\"children\":[\"\\n\",\"$L41\",\"\\n\",\"$L42\",\"\\n\"]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"27:[\"$\",\"h3\",null,{\"id\":\"unlock-phase\",\"children\":[[\"$\",\"a\",null,{\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"href\":\"#unlock-phase\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"Unlock Phase\"]}]\n"])</script><script>self.__next_f.push([1,"28:[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":\"Let the user enter a password, encode it in UTF-8, and derive the corresponding Argon2id key\\nusing the parameters above.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Convert the 64-byte Argon2id key to a BLS scalar via modular reduction. Let \",[\"$\",\"span\",null,{\"className\":\"katex\",\"children\":[[\"$\",\"span\",null,{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",null,{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",null,{\"children\":[[\"$\",\"mrow\",null,{\"children\":[\"$\",\"mi\",null,{\"children\":\"z\"}]}],[\"$\",\"annotation\",null,{\"encoding\":\"application/x-tex\",\"children\":\"z\"}]]}]}]}],[\"$\",\"span\",null,{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"0.4306em\"}}],[\"$\",\"span\",null,{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.04398em\"},\"children\":\"z\"}]]}]}]]}],\" be this scalar.\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"For each KZG proof in the \",[\"$\",\"code\",null,{\"children\":\"y\"}],\" array:\"]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"if the proof successfully verifies that \",[\"$\",\"span\",null,{\"className\":\"katex\",\"children\":[[\"$\",\"span\",null,{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",null,{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",null,{\"children\":[[\"$\",\"mrow\",null,{\"children\":[\"$\",\"mi\",null,{\"children\":\"z\"}]}],[\"$\",\"annotation\",null,{\"encoding\":\"application/x-tex\",\"children\":\"z\"}]]}]}]}],[\"$\",\"span\",null,{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"0.4306em\"}}],[\"$\",\"span\",null,{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.04398em\"},\"children\":\"z\"}]]}]}]]}],\" is a root of the polynomial commited to by \",[\"$\",\"code\",null,{\"children\":\"c\"}],\",\\nthen the password is correct;\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"if none of the proofs work, show an invalid password error message and exit.\"}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"To compute the private BLS key of the \",[\"$\",\"em\",null,{\"children\":\"i\"}],\"-th account:\"]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"Let \",[\"$\",\"code\",null,{\"children\":\"H\"}],\" be the SHA3-512 hash of a 104-byte message built as follows:\",\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"the first 64 bytes are the seed \",[\"$\",\"code\",null,{\"children\":\"s\"}],\",\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"the next 32 bytes are the key scalar \",[\"$\",\"span\",null,{\"className\":\"katex\",\"children\":[[\"$\",\"span\",null,{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",null,{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",null,{\"children\":[[\"$\",\"mrow\",null,{\"children\":[\"$\",\"mi\",null,{\"children\":\"z\"}]}],[\"$\",\"annotation\",null,{\"encoding\":\"application/x-tex\",\"children\":\"z\"}]]}]}]}],[\"$\",\"span\",null,{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"0.4306em\"}}],[\"$\",\"span\",null,{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.04398em\"},\"children\":\"z\"}]]}]}]]}],\" in little endian order,\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"the final 8 bytes are the index \",[\"$\",\"code\",null,{\"children\":\"i\"}],\" in little endian order.\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"Convert \",[\"$\",\"code\",null,{\"children\":\"H\"}],\" to a BLS scalar via modular reduction. The scalar is the private key.\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":\"The public BLS key is computed over G1 as usual (ECC multiplication by the G1 generator point).\"}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":\"The account address is obtained by computing the SHA3-512 hash of the public key point in\\ncompressed form (48 bytes) and converting the hash to a BLS scalar via modular reduction.\"}],\"\\n\"]}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"29:[\"$\",\"div\",null,{\"className\":\"my-8 flex rounded-3xl p-6 bg-sky-50 dark:bg-slate-800/60 dark:ring-1 dark:ring-slate-300/10\",\"children\":[[\"$\",\"svg\",null,{\"viewBox\":\"0 0 32 32\",\"fill\":\"none\",\"className\":\"h-8 w-8 flex-none [--icon-foreground:var(--color-slate-900)] [--icon-background:var(--color-white)]\",\"children\":[[\"$\",\"defs\",null,{\"children\":[[\"$\",\"radialGradient\",null,{\"cx\":0,\"cy\":0,\"r\":1,\"gradientUnits\":\"userSpaceOnUse\",\"id\":\"_S_4_-gradient\",\"gradientTransform\":\"matrix(0 21 -21 0 20 11)\",\"children\":[[\"$\",\"stop\",\"0\",{\"stopColor\":\"#0EA5E9\"}],[\"$\",\"stop\",\"1\",{\"stopColor\":\"#22D3EE\",\"offset\":\".527\"}],[\"$\",\"stop\",\"2\",{\"stopColor\":\"#818CF8\",\"offset\":1}]]}],[\"$\",\"radialGradient\",null,{\"cx\":0,\"cy\":0,\"r\":1,\"gradientUnits\":\"userSpaceOnUse\",\"id\":\"_S_4_-gradient-dark\",\"gradientTransform\":\"matrix(0 24.5001 -19.2498 0 16 5.5)\",\"children\":[[\"$\",\"stop\",\"0\",{\"stopColor\":\"#0EA5E9\"}],[\"$\",\"stop\",\"1\",{\"stopColor\":\"#22D3EE\",\"offset\":\".527\"}],[\"$\",\"stop\",\"2\",{\"stopColor\":\"#818CF8\",\"offset\":1}]]}]]}],[\"$\",\"g\",null,{\"className\":\"dark:hidden\",\"children\":[[\"$\",\"circle\",null,{\"cx\":20,\"cy\":20,\"r\":12,\"fill\":\"url(#_S_4_-gradient)\"}],[\"$\",\"path\",null,{\"fillRule\":\"evenodd\",\"clipRule\":\"evenodd\",\"d\":\"M20 24.995c0-1.855 1.094-3.501 2.427-4.792C24.61 18.087 26 15.07 26 12.231 26 7.133 21.523 3 16 3S6 7.133 6 12.23c0 2.84 1.389 5.857 3.573 7.973C10.906 21.494 12 23.14 12 24.995V27a2 2 0 0 0 2 2h4a2 2 0 0 0 2-2v-2.005Z\",\"className\":\"fill-(--icon-background)\",\"fillOpacity\":0.5}],[\"$\",\"path\",null,{\"d\":\"M25 12.23c0 2.536-1.254 5.303-3.269 7.255l1.391 1.436c2.354-2.28 3.878-5.547 3.878-8.69h-2ZM16 4c5.047 0 9 3.759 9 8.23h2C27 6.508 21.998 2 16 2v2Zm-9 8.23C7 7.76 10.953 4 16 4V2C10.002 2 5 6.507 5 12.23h2Zm3.269 7.255C8.254 17.533 7 14.766 7 12.23H5c0 3.143 1.523 6.41 3.877 8.69l1.392-1.436ZM13 27v-2.005h-2V27h2Zm1 1a1 1 0 0 1-1-1h-2a3 3 0 0 0 3 3v-2Zm4 0h-4v2h4v-2Zm1-1a1 1 0 0 1-1 1v2a3 3 0 0 0 3-3h-2Zm0-2.005V27h2v-2.005h-2ZM8.877 20.921C10.132 22.136 11 23.538 11 24.995h2c0-2.253-1.32-4.143-2.731-5.51L8.877 20.92Zm12.854-1.436C20.32 20.852 19 22.742 19 24.995h2c0-1.457.869-2.859 2.122-4.074l-1.391-1.436Z\",\"className\":\"fill-(--icon-foreground)\"}],[\"$\",\"path\",null,{\"d\":\"M20 26a1 1 0 1 0 0-2v2Zm-8-2a1 1 0 1 0 0 2v-2Zm2 0h-2v2h2v-2Zm1 1V13.5h-2V25h2Zm-5-11.5v1h2v-1h-2Zm3.5 4.5h5v-2h-5v2Zm8.5-3.5v-1h-2v1h2ZM20 24h-2v2h2v-2Zm-2 0h-4v2h4v-2Zm-1-10.5V25h2V13.5h-2Zm2.5-2.5a2.5 2.5 0 0 0-2.5 2.5h2a.5.5 0 0 1 .5-.5v-2Zm2.5 2.5a2.5 2.5 0 0 0-2.5-2.5v2a.5.5 0 0 1 .5.5h2ZM18.5 18a3.5 3.5 0 0 0 3.5-3.5h-2a1.5 1.5 0 0 1-1.5 1.5v2ZM10 14.5a3.5 3.5 0 0 0 3.5 3.5v-2a1.5 1.5 0 0 1-1.5-1.5h-2Zm2.5-3.5a2.5 2.5 0 0 0-2.5 2.5h2a.5.5 0 0 1 .5-.5v-2Zm2.5 2.5a2.5 2.5 0 0 0-2.5-2.5v2a.5.5 0 0 1 .5.5h2Z\",\"className\":\"fill-(--icon-foreground)\"}]]}],[\"$\",\"g\",null,{\"className\":\"hidden dark:inline\",\"children\":[\"$\",\"path\",null,{\"fillRule\":\"evenodd\",\"clipRule\":\"evenodd\",\"d\":\"M16 2C10.002 2 5 6.507 5 12.23c0 3.144 1.523 6.411 3.877 8.691.75.727 1.363 1.52 1.734 2.353.185.415.574.726 1.028.726H12a1 1 0 0 0 1-1v-4.5a.5.5 0 0 0-.5-.5A3.5 3.5 0 0 1 9 14.5V14a3 3 0 1 1 6 0v9a1 1 0 1 0 2 0v-9a3 3 0 1 1 6 0v.5a3.5 3.5 0 0 1-3.5 3.5.5.5 0 0 0-.5.5V23a1 1 0 0 0 1 1h.36c.455 0 .844-.311 1.03-.726.37-.833.982-1.626 1.732-2.353 2.354-2.28 3.878-5.547 3.878-8.69C27 6.507 21.998 2 16 2Zm5 25a1 1 0 0 0-1-1h-8a1 1 0 0 0-1 1 3 3 0 0 0 3 3h4a3 3 0 0 0 3-3Zm-8-13v1.5a.5.5 0 0 1-.5.5 1.5 1.5 0 0 1-1.5-1.5V14a1 1 0 1 1 2 0Zm6.5 2a.5.5 0 0 1-.5-.5V14a1 1 0 1 1 2 0v.5a1.5 1.5 0 0 1-1.5 1.5Z\",\"fill\":\"url(#_S_4_-gradient-dark)\"}]}]]}],[\"$\",\"div\",null,{\"className\":\"ml-4 flex-auto\",\"children\":[[\"$\",\"p\",null,{\"className\":\"not-prose font-display text-xl text-sky-900 dark:text-sky-400\",\"children\":\"Note\"}],[\"$\",\"div\",null,{\"className\":\"prose mt-2.5 text-sky-800 [--tw-prose-background:var(--color-sky-50)] prose-a:text-sky-900 prose-code:text-sky-900 dark:text-slate-300 dark:prose-code:text-slate-300\",\"children\":[\"\\n\",\"$L43\",\"\\n\",\"$L44\",\"\\n\"]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"2a:[\"$\",\"h3\",null,{\"id\":\"test-vectors\",\"children\":[[\"$\",\"a\",null,{\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"href\":\"#test-vectors\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"Test Vectors\"]}]\n2b:[\"$\",\"p\",null,{\"children\":\"TODO\"}]\n2c:[\"$\",\"h2\",null,{\"id\":\"best-practices\",\"children\":[[\"$\",\"a\",null,{\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"href\":\"#best-practices\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"Best Practices\"]}]\n2d:[\"$\",\"p\",null,{\"children\":\"Since the account key pairs are derived from both the seed and the password, changing password after\\nthe setup phase is not possible in this version of the Libernet wallet (a different password would\\ndecode different accounts). The passwords are effectively part of the secret that allows recovering\\nthe account keys, and must be treated as such. Implementors should never store these passwords\\nanywhere and should clearly indicate to the user that they cannot be recovered.\"}]\n2e:[\"$\",\"p\",null,{\"children\":[\"It is possible to add new passwords by running a new \",[\"$\",\"a\",null,{\"href\":\"#setup-phase\",\"children\":\"setup phase\"}],\" with the existing\\nseed. The new passwords will decode new accounts while the existing passwords will keep decoding the\\nexisting accounts.\"]}]\n2f:[\"$\",\"p\",null,{\"children\":[\"Since we hard-coded a limit of 10 passwords per wallet, implementations \",[\"$\",\"strong\",null,{\"children\":\"must never\"}],\" allow more,\\nas doing so would invalidate plausible deniability by revealing that the user is using more than 10\\npasswords.\"]}]\n30:[\"$\",\"p\",null,{\"children\":[\"Never allow two or more identical passwords in the setup phase, as those would yield identical\\nproofs in the \",[\"$\",\"code\",null,{\"children\":\"y\"}],\" array and degrade plausible deniability by leaking information. For example, if\\nthree elements of \",[\"$\",\"code\",null,{\"children\":\"y\"}],\" are identical it means the user repeated the same password 3 times and is\\nusing no more than 7 other passwords.\"]}]\n31:[\"$\",\"p\",null,{\"children\":\"Since the user is expected to remember all passwords, backing up the seed alone is sufficient to\\nback up the entire wallet. When restoring a backup, implementors can run the setup phase asking the\\nuser to provide all passwords. If one or more passwords can't be provided right away, a new setup\\nphase can always be run later.\"}]\n32:[\"$\",\"p\",null,{\"children\":\"Even though the seed alone is insufficient to recover any account keys it's unadvisable to store it\\nin cleartext when backing it up. The Argon2 key derivation function we use will resist dictionary\\nand brute force attacks even if carried out by highly parallel actors equipped with GPU clusters,\\nbut a targeted attack may use a relatively small dictionary and become successful (in layman's\\nterms, someone who knows you well enough might just guess your password right).\"}]\n33:[\"$\",\"$L45\",null,{\"children\":[\"$\",\"$37\",null,{\"name\":\"Next.MetadataOutlet\",\"children\":\"$@46\"}]}]\n"])</script><script>self.__next_f.push([1,"39:[\"$\",\"span\",null,{\"className\":\"katex\",\"children\":[[\"$\",\"span\",null,{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",null,{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",null,{\"children\":[[\"$\",\"mrow\",null,{\"children\":[\"$\",\"msub\",null,{\"children\":[[\"$\",\"mi\",null,{\"children\":\"z\"}],[\"$\",\"mn\",null,{\"children\":\"1\"}]]}]}],[\"$\",\"annotation\",null,{\"encoding\":\"application/x-tex\",\"children\":\"z_1\"}]]}]}]}],[\"$\",\"span\",null,{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"0.5806em\",\"verticalAlign\":\"-0.15em\"}}],[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":[[\"$\",\"span\",null,{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.04398em\"},\"children\":\"z\"}],[\"$\",\"span\",null,{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",null,{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",null,{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",null,{\"className\":\"vlist\",\"style\":{\"height\":\"0.3011em\"},\"children\":[\"$\",\"span\",null,{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"-0.044em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",null,{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord mtight\",\"children\":\"1\"}]}]]}]}],[\"$\",\"span\",null,{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",null,{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",null,{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",null,{}]}]}]]}]}]]}]]}]}]]}]\n"])</script><script>self.__next_f.push([1,"3a:[\"$\",\"span\",null,{\"className\":\"katex\",\"children\":[[\"$\",\"span\",null,{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",null,{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",null,{\"children\":[[\"$\",\"mrow\",null,{\"children\":[\"$\",\"mi\",null,{\"children\":\"P\"}]}],[\"$\",\"annotation\",null,{\"encoding\":\"application/x-tex\",\"children\":\"P\"}]]}]}]}],[\"$\",\"span\",null,{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"0.6833em\"}}],[\"$\",\"span\",null,{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.13889em\"},\"children\":\"P\"}]]}]}]]}]\n3b:[\"$\",\"span\",null,{\"className\":\"katex\",\"children\":[[\"$\",\"span\",null,{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",null,{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",null,{\"children\":[[\"$\",\"mrow\",null,{\"children\":[\"$\",\"mi\",null,{\"children\":\"P\"}]}],[\"$\",\"annotation\",null,{\"encoding\":\"application/x-tex\",\"children\":\"P\"}]]}]}]}],[\"$\",\"span\",null,{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"0.6833em\"}}],[\"$\",\"span\",null,{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.13889em\"},\"children\":\"P\"}]]}]}]]}]\n"])</script><script>self.__next_f.push([1,"3c:[\"$\",\"span\",null,{\"className\":\"katex-display\",\"children\":[\"$\",\"span\",null,{\"className\":\"katex\",\"children\":[[\"$\",\"span\",null,{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",null,{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\",\"children\":[\"$\",\"semantics\",null,{\"children\":[[\"$\",\"mrow\",null,{\"children\":[[\"$\",\"mi\",null,{\"children\":\"α\"}],[\"$\",\"mo\",null,{\"children\":\"⋅\"}],[\"$\",\"mo\",null,{\"stretchy\":\"false\",\"children\":\"(\"}],[\"$\",\"mi\",null,{\"children\":\"x\"}],[\"$\",\"mo\",null,{\"children\":\"−\"}],[\"$\",\"msub\",null,{\"children\":[[\"$\",\"mi\",null,{\"children\":\"z\"}],[\"$\",\"mn\",null,{\"children\":\"0\"}]]}],[\"$\",\"mo\",null,{\"stretchy\":\"false\",\"children\":\")\"}],[\"$\",\"mo\",null,{\"children\":\"⋅\"}],[\"$\",\"mo\",null,{\"stretchy\":\"false\",\"children\":\"(\"}],[\"$\",\"mi\",null,{\"children\":\"x\"}],[\"$\",\"mo\",null,{\"children\":\"−\"}],[\"$\",\"msub\",null,{\"children\":[[\"$\",\"mi\",null,{\"children\":\"z\"}],[\"$\",\"mn\",null,{\"children\":\"1\"}]]}],[\"$\",\"mo\",null,{\"stretchy\":\"false\",\"children\":\")\"}],[\"$\",\"mo\",null,{\"children\":\"⋅\"}],[\"$\",\"mi\",null,{\"mathvariant\":\"normal\",\"children\":\".\"}],[\"$\",\"mi\",null,{\"mathvariant\":\"normal\",\"children\":\".\"}],[\"$\",\"mi\",null,{\"mathvariant\":\"normal\",\"children\":\".\"}],[\"$\",\"mo\",null,{\"children\":\"⋅\"}],[\"$\",\"mo\",null,{\"stretchy\":\"false\",\"children\":\"(\"}],[\"$\",\"mi\",null,{\"children\":\"x\"}],[\"$\",\"mo\",null,{\"children\":\"−\"}],[\"$\",\"msub\",null,{\"children\":[[\"$\",\"mi\",null,{\"children\":\"z\"}],[\"$\",\"mn\",null,{\"children\":\"9\"}]]}],[\"$\",\"mo\",null,{\"stretchy\":\"false\",\"children\":\")\"}]]}],[\"$\",\"annotation\",null,{\"encoding\":\"application/x-tex\",\"children\":\"\\\\alpha \\\\cdot (x - z_0) \\\\cdot (x - z_1) \\\\cdot ... \\\\cdot (x - z_9)\"}]]}]}]}],[\"$\",\"span\",null,{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"0.4445em\"}}],[\"$\",\"span\",null,{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.0037em\"},\"children\":\"α\"}],[\"$\",\"span\",null,{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",null,{\"className\":\"mbin\",\"children\":\"⋅\"}],[\"$\",\"span\",null,{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}]]}],[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"1em\",\"verticalAlign\":\"-0.25em\"}}],[\"$\",\"span\",null,{\"className\":\"mopen\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"mord mathnormal\",\"children\":\"x\"}],[\"$\",\"span\",null,{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",null,{\"className\":\"mbin\",\"children\":\"−\"}],[\"$\",\"span\",null,{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}]]}],[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"1em\",\"verticalAlign\":\"-0.25em\"}}],[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":[[\"$\",\"span\",null,{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.04398em\"},\"children\":\"z\"}],[\"$\",\"span\",null,{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",null,{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",null,{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",null,{\"className\":\"vlist\",\"style\":{\"height\":\"0.3011em\"},\"children\":[\"$\",\"span\",null,{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"-0.044em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",null,{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord mtight\",\"children\":\"0\"}]}]]}]}],[\"$\",\"span\",null,{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",null,{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",null,{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",null,{}]}]}]]}]}]]}],[\"$\",\"span\",null,{\"className\":\"mclose\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",null,{\"className\":\"mbin\",\"children\":\"⋅\"}],[\"$\",\"span\",null,{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}]]}],[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"1em\",\"verticalAlign\":\"-0.25em\"}}],[\"$\",\"span\",null,{\"className\":\"mopen\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"mord mathnormal\",\"children\":\"x\"}],[\"$\",\"span\",null,{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",null,{\"className\":\"mbin\",\"children\":\"−\"}],[\"$\",\"span\",null,{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}]]}],[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"1em\",\"verticalAlign\":\"-0.25em\"}}],[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":[[\"$\",\"span\",null,{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.04398em\"},\"children\":\"z\"}],[\"$\",\"span\",null,{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",null,{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",null,{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",null,{\"className\":\"vlist\",\"style\":{\"height\":\"0.3011em\"},\"children\":[\"$\",\"span\",null,{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"-0.044em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",null,{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord mtight\",\"children\":\"1\"}]}]]}]}],[\"$\",\"span\",null,{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],\"$L47\"]}]}]]}],\"$L48\",\"$L49\",\"$L4a\",\"$L4b\"]}],\"$L4c\",\"$L4d\",\"$L4e\"]}]]}]}]\n"])</script><script>self.__next_f.push([1,"3d:[\"$\",\"p\",null,{\"children\":[\"where \",[\"$\",\"span\",null,{\"className\":\"katex\",\"children\":[[\"$\",\"span\",null,{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",null,{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",null,{\"children\":[[\"$\",\"mrow\",null,{\"children\":[\"$\",\"mi\",null,{\"children\":\"α\"}]}],[\"$\",\"annotation\",null,{\"encoding\":\"application/x-tex\",\"children\":\"\\\\alpha\"}]]}]}]}],[\"$\",\"span\",null,{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"0.4306em\"}}],[\"$\",\"span\",null,{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.0037em\"},\"children\":\"α\"}]]}]}]]}],\" is a random BLS scalar.\"]}]\n"])</script><script>self.__next_f.push([1,"3e:[\"$\",\"li\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Let \",[\"$\",\"code\",null,{\"children\":\"c\"}],\" be the KZG commitment of \",[\"$\",\"span\",null,{\"className\":\"katex\",\"children\":[[\"$\",\"span\",null,{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",null,{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",null,{\"children\":[[\"$\",\"mrow\",null,{\"children\":[\"$\",\"mi\",null,{\"children\":\"P\"}]}],[\"$\",\"annotation\",null,{\"encoding\":\"application/x-tex\",\"children\":\"P\"}]]}]}]}],[\"$\",\"span\",null,{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"0.6833em\"}}],[\"$\",\"span\",null,{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.13889em\"},\"children\":\"P\"}]]}]}]]}],\" over G1 and \",[\"$\",\"code\",null,{\"children\":\"y\"}],\" the list of KZG proofs of the 10 root points\\n\",[\"$\",\"span\",null,{\"className\":\"katex\",\"children\":[[\"$\",\"span\",null,{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",null,{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",null,{\"children\":[[\"$\",\"mrow\",null,{\"children\":[[\"$\",\"mo\",null,{\"stretchy\":\"false\",\"children\":\"(\"}],[\"$\",\"msub\",null,{\"children\":[[\"$\",\"mi\",null,{\"children\":\"z\"}],[\"$\",\"mi\",null,{\"children\":\"i\"}]]}],[\"$\",\"mo\",null,{\"separator\":\"true\",\"children\":\",\"}],[\"$\",\"mn\",null,{\"children\":\"0\"}],[\"$\",\"mo\",null,{\"stretchy\":\"false\",\"children\":\")\"}]]}],[\"$\",\"annotation\",null,{\"encoding\":\"application/x-tex\",\"children\":\"(z_i, 0)\"}]]}]}]}],[\"$\",\"span\",null,{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"1em\",\"verticalAlign\":\"-0.25em\"}}],[\"$\",\"span\",null,{\"className\":\"mopen\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":[[\"$\",\"span\",null,{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.04398em\"},\"children\":\"z\"}],[\"$\",\"span\",null,{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",null,{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",null,{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",null,{\"className\":\"vlist\",\"style\":{\"height\":\"0.3117em\"},\"children\":[\"$\",\"span\",null,{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"-0.044em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",null,{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord mathnormal mtight\",\"children\":\"i\"}]}]]}]}],[\"$\",\"span\",null,{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",null,{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",null,{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",null,{}]}]}]]}]}]]}],[\"$\",\"span\",null,{\"className\":\"mpunct\",\"children\":\",\"}],[\"$\",\"span\",null,{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"mclose\",\"children\":\")\"}]]}]}]]}],\".\"]}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"3f:[\"$\",\"li\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Shuffle the \",[\"$\",\"code\",null,{\"children\":\"y\"}],\" list (you can use the \",[\"$\",\"a\",null,{\"href\":\"https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle\",\"children\":\"Fisher-Yates shuffle\"}],\" with a\\nCSPRNG).\"]}],\"\\n\"]}]\n40:[\"$\",\"li\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Store \",[\"$\",\"code\",null,{\"children\":\"s\"}],\", \",[\"$\",\"code\",null,{\"children\":\"c\"}],\", and \",[\"$\",\"code\",null,{\"children\":\"y\"}],\" to the wallet file.\"]}],\"\\n\"]}]\n41:null\n42:[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Step #8 is \",[\"$\",\"strong\",null,{\"children\":\"very important\"}],\" to maintain plausible deniability. Don't store the proofs for the\\nactual passwords first and those for the random keys last, for example. The order of the proofs\\n\",[\"$\",\"strong\",null,{\"children\":\"must\"}],\" be randomized securely.\"]}],\"\\n\"]\n43:null\n44:[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"To prevent timing attacks the algorithm at point #3 must run in constant time, therefore\\nimplementors must check \",[\"$\",\"span\",null,{\"className\":\"katex\",\"children\":[[\"$\",\"span\",null,{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",null,{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",null,{\"children\":[[\"$\",\"mrow\",null,{\"children\":[\"$\",\"mi\",null,{\"children\":\"z\"}]}],[\"$\",\"annotation\",null,{\"encoding\":\"application/x-tex\",\"children\":\"z\"}]]}]}]}],[\"$\",\"span\",null,{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"0.4306em\"}}],[\"$\",\"span\",null,{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.04398em\"},\"children\":\"z\"}]]}]}]]}],\" against \",[\"$\",\"strong\",null,{\"children\":\"all\"}],\" 10 proofs even if one succeeds before checking the\\nlast.\"]}],\"\\n\"]\n"])</script><script>self.__next_f.push([1,"47:[\"$\",\"span\",null,{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",null,{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",null,{}]}]}]\n48:[\"$\",\"span\",null,{\"className\":\"mclose\",\"children\":\")\"}]\n49:[\"$\",\"span\",null,{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}]\n4a:[\"$\",\"span\",null,{\"className\":\"mbin\",\"children\":\"⋅\"}]\n4b:[\"$\",\"span\",null,{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}]\n4c:[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"0.4445em\"}}],[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":\"...\"}],[\"$\",\"span\",null,{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",null,{\"className\":\"mbin\",\"children\":\"⋅\"}],[\"$\",\"span\",null,{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}]]}]\n4d:[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"1em\",\"verticalAlign\":\"-0.25em\"}}],[\"$\",\"span\",null,{\"className\":\"mopen\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"mord mathnormal\",\"children\":\"x\"}],[\"$\",\"span\",null,{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",null,{\"className\":\"mbin\",\"children\":\"−\"}],[\"$\",\"span\",null,{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}]]}]\n4e:[\"$\",\"span\",null,{\"className\":\"base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"strut\",\"style\":{\"height\":\"1em\",\"verticalAlign\":\"-0.25em\"}}],[\"$\",\"span\",null,{\"className\":\"mord\",\"children\":[[\"$\",\"span\",null,{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.04398em\"},\"children\":\"z\"}],[\"$\",\"span\",null,{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",null,{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",null,{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",null,{\"className\":\"vlist\",\"style\":{\"height\":\"0.3011em\"},\"children\":[\"$\",\"span\",null,{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"-0.044em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",null,{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",null,{\"className\":\"mord mtight\",\"children\":\"9\"}]}]]}]}],[\"$\",\"span\",null,{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",null,{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",null,{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",null,{}]}]}]]}]}]]}],[\"$\",\"span\",null,{\"className\":\"mclose\",\"children\":\")\"}]]}]\n"])</script><script>self.__next_f.push([1,"35:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"4f:I[27201,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/247eb132b7f7b574.js\"],\"IconMark\"]\n38:[[\"$\",\"title\",\"0\",{\"children\":\"Libernet Documentation\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Libernet Documentation\"}],[\"$\",\"link\",\"2\",{\"rel\":\"author\",\"href\":\"https://libernet.xyz\"}],[\"$\",\"meta\",\"3\",{\"name\":\"author\",\"content\":\"The Libernet team\"}],[\"$\",\"link\",\"4\",{\"rel\":\"icon\",\"href\":\"/_next/static/media/favicon.9a94e18a.png\"}],[\"$\",\"$L4f\",\"5\",{}]]\n"])</script><script>self.__next_f.push([1,"46:null\n"])</script></body></html>